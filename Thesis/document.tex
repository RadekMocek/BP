% !TEX TS-program = xelatex

% Inicializace tulthesis
\documentclass[FM]{tulthesis}
% Typografie pro češtinu; xelatex alternativa pro babel
\usepackage{polyglossia}
\setdefaultlanguage{czech}
% Automatické pevné mezery
\usepackage{xevlna}
% Zabránění vdov a sirotků
\usepackage[all]{nowidow}
% Snížit šanci na rozdělení posledního slova odstavce
\finalhyphendemerits=200000
% Tabulky
\usepackage{threeparttable} % Tabulka s vlastními footnotes
\usepackage[table]{xcolor}  % Tabulka s různě barevnými řádky
%\usepackage{makecell}	    % Víceřádkové buňky
% Zdrojové kódy
\input{code/syntaxhighlight}
% Barevný verb (pro tabulku s ukázkou __aprox_tex_len)
\usepackage{newverbs}
% Přidání možností pro enumerate u obrázku 2.1
\usepackage{enumitem}

% Pro seznam použité literatury
\usepackage[backend=biber, style=iso-numeric]{biblatex}
\addbibresource{zdroje.bib}
% Poslední dva autory knihy neoddělovat středníkem ale písmenem 'a'
\DeclareDelimFormat{finalnamedelim}{\addspace a\space}

% Název práce
\TULtitle{Tvorba a využití botu pro výuku matematiky na platformě Discord}{Creating and using a bot for teaching mathematics on the Discord platform}

% Začátek dokumentu
\begin{document}
	% Úvodní stránky
	\ThesisStart{zadani.pdf}
	
	% Poděkování
	\begin{acknowledgement}
		Děkuji
	\end{acknowledgement}
	
	% Abstrakt česky
	\begin{abstractCZ}
		Abstrakt česky		
		% Abstrakt nebo též Referát je stručný výtah z celého díla; shrnuje obsah textu, konkrétní cíle, metodiku řešení, komentuje výsledky a závěry. Abstrakt slouží k tomu, aby se čtenář mohl na základě přečtení abstraktu rozhodnout, zda je pro něj přínosné číst celou práci.
	\end{abstractCZ}
	
	% Klíčová slova česky
	\begin{keywordsCZ}
		Klíčová slova česky
	\end{keywordsCZ}
	\vspace{2cm}
	
	% Abstrakt anglicky
	\begin{abstractEN}
		Abstrakt anglicky
	\end{abstractEN}
	
	% Klíčová slova anglicky
	\begin{keywordsEN}
		Klíčová slova anglicky
	\end{keywordsEN}
	
	% Obsah
	\tableofcontents
	
	% Seznam obrázků
	\listoffigures
	
	% Seznam tabulek
	\listoftables
	
	\clearpage
	
	% Zkratky
	\begin{abbrList}
		\textbf{API} & Application Programming Interface, rozhraní pro programování aplikací \\
		\textbf{DMs} & Direct Messages, přímé zprávy \\
		\textbf{HTML} & Hypertext Markup Language, značkovací jazyk \\
		\textbf{HTTPS} & Hypertext Transfer Protocol Secure, protokol pro zabezpečenou komunikaci po počítačové síti \\
		\textbf{ID} & identifikace, identifikátor \\
		\textbf{JDA} & Java Discord API, knihovna pro tvorbu Discord botů v jazyce Java \\
		\textbf{JSON} & JavaScript Object Notation, formát pro výměnu dat \\
		\textbf{NoSQL} & Not only SQL, typ databází \\
		\textbf{REST} & Representational State Transfer, architektura pro výměnu dat \\
		\textbf{SDK} & Software Development Kit, sada nástrojů pro vývoj softwaru \\
		\textbf{SQL} & Structured Query Language, dotazovací jazyk pro relační databáze \\
		\textbf{UI} & User Interface, uživatelské rozhraní \\
		\textbf{VoIP} & Voice over Internet Protocol, telefonie přes internetový protokol \\
	\end{abbrList}
	
	% Začátek hlavního textu
	
	% 1. Vypracujte rešerši sociálních platforem, které umožňují integraci botů.
	% 2. Analyzujte vybranou skupinu existujících botů na platformě Discord a knihoven pro jejich tvorbu.
	% 3. Navrhněte bot zaměřený na výklad a příklady z lineární algebry při využití specifických funkcí Discordu včetně administrace a interaktivních zpráv.
	% 4. Navržené řešení implementujte a nasaďte do testovacího provozu pro vybranou skupinu uživatelů.
	% 5. Vyhodnoďte zpětnou vazbu od uživatelů a navrhněte případné úpravy a vylepšení.
	
	\chapter{Úvod}
	
	% Úvod
	% – Stručné vysvětlení problematiky, uvedení řešeného problému a motivace k jeho řešení
	% – pokud motivace není jasná, práce se špatně řeší (a obhajuje)…
	% – v takovém případě je dobré (nutné) zeptat se vedoucího)
	% Cíl práce
	% – Jasné a poměrně přesné vymezení předmětu práce
	% – BP málo kdy řeší rozsáhlé a komplexní problémy, spíše jen dílčí úlohy za určitých omezujících podmínek …
	% – …a toto všechno je potřeba deklarovat
	
	% V úvodu by měly být uvedeny účel a cíle práce a v hrubých rysech popsána metoda řešení. Rozhodně by se neměl opakovat text abstraktu, ani by zde neměly být popisovány výsledky.
	
	%(a) Je shrnuto zadánı́ práce?
	%(b) Je naznačena struktura práce?
	%(c) Neopakuje se text abstraktu?
	%(d) Nejsou prozrazeny výsledky práce?
	
	Cílem této práce je přiblížit problematiku tvorby botů pro sociální platformu \mbox{Discord}. Tato platforma, která původně vznikla za účelem poskytnutí online komunikace pro hráče videoher, se dnes řadí mezi nejpoužívanější nástroje pro okamžité zasílání zpráv a internetovou telefonii.
			
	\chapter{Boti na sociálních platformách}\label{Chapter2}
	
	Tato kapitola představuje Discord a některé další sociální platformy, které přímo podporují tvorbu a integraci botů. Nejdříve je ale nutné upřesnit, jak jsou v tomto kontextu myšleny výrazy \textit{sociální platforma} a \textit{bot}.
	
	Discord je vcelku obtížné zařadit do jedné konkrétní kategorie softwaru. Dokud se nově zaregistrovaný uživatel nepřipojí na žádný server, pak se Discord chová jako VoIP a instant messaging aplikace, kde lze komunikovat pouze s lidmi, které si uživatel přidá do přátel. Po připojení na nějaký veřejný Discord server se ale aplikace přibližuje ke kategorii sociálních médií, kdy uživatel může sdílet a konzumovat obsah v rámci moderované komunity. Pojem sociální platforma je zde tedy myšlen spíše jako zastřešující termín pro Discord a jemu podobné aplikace, u nichž o zařazení do této kapitoly především rozhodovalo, zdali nějakým způsobem podporují integraci botů. Společnou vlastností níže zmíněných platforem je také to, že všechny mají k dispozici aplikace pro web, desktop a mobilní zařízení.
	
	Uživatelé sociálních médií často vnímají pojem bot negativně, jelikož se mezi boty mimo jiné řadí i programy generující spam nebo umělou návštěvnost za účelem zkreslení statistik \cite{lit_Discord}. Na platformách zkoumaných v této kapitole je ale bot speciální typ uživatele, jehož chování je automatizované a určené programem. Tento bot je zpravidla přidán do skupinové konverzace, kde pak za pomoci volání API dané platformy dokáže provádět stejné akce jako běžný uživatel. Jedná se například o odesílání zpráv a čtení jejich obsahu, moderaci členů serveru, nebo i připojení do hlasového hovoru. Nemusí se jednat o chatbota, který se snaží imitovat lidské chování. Bot obvykle reaguje na předem danou sadu příkazů vykonáním určité činnosti.
		
	Aby byl bot online a funkční, musí být program, který definuje jeho chování, neustále spuštěný. O to se zkoumané platformy zpravidla nestarají, a proto je nutné mít program spuštěný na vlastním serveru nebo využít hosting třetí strany. Tento program pak komunikuje s danou platformou např. pomocí protokolu \mbox{WebSocket}. Komunikace může být velmi komplexní, proto vznikají komunitní i oficiální knihovny, které tvorbu bota značně usnadňují.
	
	Účet pro bota může být založen v rozhraní pro vývojáře (např. \textit{Discord Developer Portal}), kde je následně vygenerován jeho ověřovací token. Ten se pak používá při komunikaci programu s platformou a měl by zůstat tajný, jinak může dojít k tzv. odcizení bota. To znamená, že někdo jiný použije svůj vlastní program společně s uniklým tokenem pro předefinování chování bota, k jehož účtu daný token náleží.
	
	\begin{table}[ht]
		\centering
		\caption{Přehled sociálních platforem}\medskip
		\rowcolors{2}{gray!10}{}
		\begin{threeparttable}
			\begin{tabular}{ l c r c c }
				\textbf{Název}&\textbf{Vznik}&\textbf{Návštěv}\tnote{*}&\textbf{Bezplatná verze}&\textbf{Zaměření}\\\hline
				Discord&2015&864 100 000&Ano&Obecné\\
				Teams&2017&320 690 000&Omezená&Firemní\\
				Slack&2013&97 000 000&Omezená&Firemní\\
				Guilded&2017&1 260 000&Ano&Herní\\				
				Matrix/Element&2014/2016&494 420&FOSS&Obecné\\				
				Flock&2014&161 300&Omezená&Firemní\\
				Revolt&2021&136 970&FOSS&Obecné\\
			\hline\end{tabular}
			\bigskip%Musí následovat prázdný řádek
		
			\rowcolors{2}{gray!10}{}
			\begin{tabular}{ l c c c c }
				\textbf{Název}&\textbf{Čeština}&\textbf{Oficiální SDK}&\textbf{Markdown}\tnote{**}&\textbf{TeX}\\\hline
				Discord&Ano&Ne&5&Ne\\
				Teams&Ano&Ano&3&Ne\\
				Slack&Ne&Ano&2&Ne\\
				Guilded&Ne&Ne&4&Ne\\				
				Matrix/Element&Ano&Ano&4&Ne\\				
				Flock&Ne&Ano&1&Ne\\
				Revolt&Ano&Ano&5&Ano\\
			\hline\end{tabular}			
			\begin{tablenotes}
				\item[*] počet návštěv hlavní webové stránky\\za únor 2024 podle společnosti Semrush\smallskip
				\item[**] 0 až 5 bodů za: kurzíva, seznamy, víceúrovňové nadpisy,\\odkazy a zdrojový kód se zvýrazněním klíčových slov
			\end{tablenotes}
		\end{threeparttable}
	\end{table}
	
	\section{Discord}
	
	Platforma Discord vznikla v roce 2015 jako reakce na nedostatky tehdejších služeb pro online komunikaci mezi hráči videoher \cite{lit_Discord}. S nabývající popularitou se ale na Discordu začaly objevovat veřejné komunity zaměřené i na jiná témata, než ta herní. Často se jedná o oficiálně vytvořené servery patřící k určitému produktu, které slouží jako diskuzní fórum a propagace zároveň. Momentálně je podle počtu členů největší komunitou server Midjourney, který patří ke stejnojmennému nástroji pro tvorbu obrázků pomocí umělé inteligence. Uživatelé zde mohou o nástroji diskutovat, hlásit chyby, sdílet vytvořené obrázky, nebo je nechat generovat použitím Midjourney bota.
	
	Základní verze Discordu je zdarma s možností měsíčního předplatného \textit{Discord Nitro}. Předplatitelé mají navíc k dispozici kosmetické prvky (např. animovaný avatar a vlastní emotikony) a některé základní funkce jsou pro ně vylepšeny (např. nahrávání větších souborů a streamování videa ve vyšším rozlišení).	

	Program disponuje obvyklou instant messaging a VoIP funkcionalitou. V tzv. přímých zprávách si mezi sebou uživatelé mohou posílat textové zprávy a soubory. Textové zprávy je možné formátovat v jazyce Markdown pro psaní tučného textu, nadpisů, seznamů a zdrojových kódů se zvýrazněním klíčových slov. Dále je k dispozici hlasový hovor s případným sdílením obrazovky a videa z webkamery. Tyto akce lze provádět i v soukromých skupinách, které ale mají omezený počet deseti uživatelů.
	
	Discord server je izolovaná kolekce uživatelů a kanálů \cite{doc_Discord}. Textové a hlasové kanály funkčně odpovídají komunikaci v soukromé skupině. Rozdíl je ten, že komunikace v kanálu se mohou účastnit všichni členové daného serveru, kterých může být v základu až 500~000. Členové k tomu ale musí mít dostatečná oprávnění. Lze jim totiž přiřazovat tzv. role, u kterých se pak tato oprávnění nastavují. Např. všichni uživatelé s rolí $x$ mohou číst historii zpráv v kanále $y$.
	
	\subsection{Aplikace a boti}
	
	Jako Discord aplikace se označuje vše, co oficiálně komunikuje s Discord API. Bot je pak automatizovaný uživatel, který může být k aplikaci přidán. Od roku 2021 jsou preferovanou metodou ovládání bota příkazy začínající lomítkem. Seznam těchto tzv. podpůrných příkazů (\textit{slash commands}) se synchronizuje s Discordem a díky tomu je pak k dispozici jejich našeptávání. Namísto příkazu umí bot reagovat i na události jako \textit{uživatel klikl na tlačítko}, nebo \textit{uživatel se připojil na server}. Botem odeslané zprávy pak mohou obsahovat interaktivní prvky jako tlačítko, výběrový seznam a textové pole. Je také možné vyvolat vyskakovací okno obsahující tyto prvky. Kromě práce se zprávami může bot také upravovat nastavení serveru, nebo se připojit do hlasového hovoru. \cite{pdf_apps101}
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=\textwidth]{img/DiscordBotCommands}
		\begin{enumerate}[nolistsep]
			\item Kanály na vybraném serveru
			\item Obsah vybraného textového kanálu
			\item Členové a boti s přístupem do vybraného kanálu
			\item Dostupné podpůrné příkazy vybraného bota
		\end{enumerate}
		\caption{Uživatelské rozhraní platformy Discord}		
	\end{figure}
	
	Boti tedy operují především na serverech\footnote{Boty lze ale používat i v přímých zprávách. Bot se sice tváří jako uživatel, do přátel ho ale přidat nelze a pro zahájení přímé konverzace je nutné s ním nejdříve mít nějaký společný server. Bota nelze přidat do soukromé skupiny.} a existuje několik možností, jak je na nějaký server pozvat. Na konci roku 2022 byl do Discordu přidán tzv. adresář aplikací (\textit{App Directory}), který momentálně obsahuje seznam více než 6000 dostupných botů, kde každý z nich má svou stránku s podrobnějším popisem a tlačítkem pro přidání na server. Aby byl bot v tomto adresáři obsažen, musí nejprve projít schvalovacím procesem, a proto se jich zde nachází pouze zlomek ze všech existujících. Každý bot pak má svůj speciální zvací odkaz (\textit{bot invite link}) a existuje několik neoficiálních databází jako \href{https://top.gg}{top.gg}, které obsahují seznam botů s jejich popisem a zvacím odkazem. Poslední možností jsou boti s otevřeným zdrojovým kódem, které si uživatel stáhne a spustí na svém stroji. Jedná se o provoz vlastní instance bota. Tento způsob tedy vyžaduje botu založit účet a vygenerovat token.
	
	Discord boti nabízející nástroje pro usnadnění moderace zejména na velkých serverech patří mezi ty nejpoužívanější. Obvykle mají svou stránku s administrací, kde si lze např. zobrazit statistiky serveru, nastavit automatické přivítání a přiřazení rolí novým členům, vyhození za spam apod. Oblíbenou kategorií byli také hudební boti, kteří v hlasovém hovoru pouštěli vybrané skladby. Jejich popularita klesla roku 2021, kdy Google zakázal provoz botů přehrávajících hudbu z webu \mbox{YouTube}. Další častá kategorie botů jsou hry a zábava. Jedná se buď o boty poskytující jednoduché hry v prostředí textového chatu, nebo propojující nějakou existující videohru s Discordem.
	
	\section{Slack}
	
	Z populárních platforem se Discordu vzhledově i funkčně nejvíce podobá program Slack. Ten byl spuštěn již v roce 2013 a od té doby si vybudoval reputaci jako standard pro komunikaci v technologických společnostech. \cite{lit_Discord}
	
	Slack se prezentuje jako software usnadňující interní komunikaci v organizacích a dal by se nazvat jako ,,Discord pro firmy``. Namísto serverů jsou zde tzv. workspaces. Workspace má své členy a textové kanály, ve kterých lze zahájit i hlasový hovor. Členové jednoho workspace si mezi sebou mohou posílat přímé zprávy a pomocí funkce \textit{Slack Connect} je možné komunikovat i s lidmi z jiného workspace. Na rozdíl od Discordu, kde jsou přímé zprávy kompletně oddělené od ekosystému serverů, se zde všechny prováděné akce dějí uvnitř nějakého workspace.
	
	Slack má k dispozici několik úrovní měsíčního předplatného a verze zdarma je značně omezena. V bezplatné verzi nelze např. zobrazit zprávy starší než 90 dnů a provozovat hlasový hovor ve více než dvou lidech. Omezené je i použití tzv. aplikací.
	
	Zdejší aplikace (\textit{Apps}) se podobají zkoumaným botům a jejich výběr odpovídá cílové skupině Slacku. Zaměřují se především na zvýšení produktivity, \mbox{teambuilding}, nebo integraci již existující služby třetí strany do prostředí Slacku. Stejně jako uživatelé mohou Slack aplikace spravovat konverzace a odesílat do nich textové zprávy. Ovládání aplikací probíhá buď pomocí příkazů začínajících lomítkem, nebo má každá aplikace svou domovskou stránku a může také generovat vyskakovací okna. Aplikací odeslané zprávy, její domovská stránka a vyskakovací okna mohou obsahovat širokou škálu interaktivních prvků jako tlačítko, zaškrtávací pole, výběr data a času apod.
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=\textwidth]{img/SlackApps}
		\caption{Doporučené Slack aplikace}
	\end{figure}
	
	Zorientovat se v procesu tvorby Slack aplikací nemusí být jednoduché. Tyto aplikace se totiž dělí na klasické (\textit{classic}) a nové (zvané \textit{modern} nebo \textit{next-generation}, představené v roce 2021), jejichž API se liší. Ani slovo bot není ve Slack ekosystému jednoznačné. U klasických aplikací se jedná o jejich speciální typ, se kterým je komunikace vedena běžnou řečí namísto příkazů nebo UI (chatbot). Tento bot je označen jako \textit{legacy} a v budoucnu pravděpodobně nebude podporován. U nového typu aplikací se z pohledu uživatele slovo bot nikde nevyskytuje (maximálně v názvu nějaké aplikace), z dokumentace je ale zjevné, že se stejně jako u Discordu jedná o speciálního uživatele ovládaného danou aplikací. Tato informace však není nikde explicitně zmíněna. Při práci s dokumentací nebo neoficiálními návody je tedy nutné dávat pozor na to, s jakou technologií daný manuál pracuje, protože může dojít ke snadné záměně výše zmíněných pojmů.
	
	Klasické Slack aplikace lze vyvíjet v řadě komunitních knihoven. \textit{Next-generation apps} pak mají připravené oficiální \mbox{TypeScript} SDK a o hosting se stará přímo Slack, pro jejich vývoj a následné nasazení je ale nutné mít placenou verzi Slacku.
	
	\section{Guilded a Revolt}
	
	Guilded a Revolt jsou platformy, které jsou přímo inspirované Discordem a podobnost mezi nimi je nepřehlédnutelná. Ekosystém uživatelů, přímých zpráv, serverů a botů je u těchto tří platforem takřka identický. Guilded ani Revolt nemají ekvivalent k podpůrným příkazům. Boti tedy musí kontrolovat obsah každé odeslané zprávy na serveru, jestli neobsahuje nějaký z jejich příkazů. Každý bot má obvykle svůj prefix jako např. vykřičník. Problém nastává, pokud má více botů stejný prefix a příkaz se stejným názvem, pak např. po napsání ,,!help`` do chatu zobrazí svou nápovědu všichni takoví boti\footnote{Tímto způsobem se před představením podpůrných příkazů ovládali i boti na Discordu. Problém stejných příkazů se řešil buď víceznakovými prefixy (menší šance na kolizi), nebo nastavitelným prefixem, to už vyžaduje úložiště uchovávající dvojice id serveru a prefix. Tento starý typ příkazů lze stále používat např. pokud je vývojář chce skrýt před běžnými uživateli, protože tyto příkazy se neobjeví v našeptávači.}. Obě platformy mají oproti Discordu znatelně menší uživatelskou základnu a počet jejich veřejných botů se pohybuje v řádu desítek.
	
	Guilded (2017) lze považovat za konkurenci Discordu, která se zaměřuje na jeho původní účel. Tím je komunikace pro hráče videoher. Guilded přidává funkce užitečné pro pořádání pravidelných komunitních událostí. Uživatel zde také může propojit svůj účet s vybranými herními tituly. \cite{web_guilded} 
	
	Program je zdarma, ale správci mohou na svém serveru zapnout dobrovolné měsíční předplatné, ze kterého je část odváděna Guilded. Pro tvorbu botů lze využít komunitních knihoven.
	
	Revolt (2021) je Discord alternativa s otevřeným zdrojovým kódem. Oproti konkurenci nemá Revolt žádné speciální funkce, díky tomu je ale méně komplikovaný. Kromě řady komunitních knihoven pro tvorbu botů je k dispozici i oficiální revolt.js. Tato knihovna byla vytvořena tak, aby do ní šel snadno migrovat bot napsaný v knihovně discord.js.
	
	\section{Další platformy}
	
	Do této sekce byly zařazeny další sociální platformy, které sice podporují implementaci botů ve smyslu automatizovaných uživatelů, ale oproti výše zmíněným platformám mají buď znatelně odlišnou strukturu a uživatelské rozhraní, nebo menší uživatelskou základnu, která se pak projevuje i v malém počtu existujících botů a malé komunitě kolem knihoven pro jejich tvorbu.
	
	\subsection{Matrix}
	
	Matrix je otevřený protokol pro šifrovanou a decentralizovanou komunikaci po síti. Existuje pro něj několik klientských aplikací jako Element a poskytovatelů jako matrix.org. Protokol je také možné provozovat na vlastním serveru. Komunikace zde probíhá v tzv. místnostech. Místnost je jeden textový kanál s možností zahájení hlasového hovoru, který může být soukromý i veřejný. Pak jsou zde tzv. prostory, které jsou v podstatě jen spravované seznamy různých místností. Podle dokumentace jsou prostory podobné Discord serverům nebo Slack workspaces, avšak zde připojení do prostoru uživatele automaticky nepřipojí do všech místností (uživatel si může vybrat, kam se připojí) a místnosti nejsou na prostorech závislé (místnost může existovat bez prostoru, může ale být i součástí více prostorů). Matrix podporuje komunikaci uživatelů s různými poskytovateli tohoto protokolu ve stejné místnosti.
	
	Bot zde není speciálním typem uživatele, ale je pro něj zaregistrován běžný uživatelský účet. Program s logikou bota tedy může ovládat jakýkoliv účet, pokud zná jeho přístupový token\footnote{V terminologii Discordu se běžné uživatelské účty řízené programem nazývají \textit{self-bots} a jejich provoz porušuje podmínky používání.}. Pro tvorbu takovýchto botů je připraveno oficiální \mbox{TypeScript} SDK. Veřejných botů pro Matrix není mnoho, mezi populární boty ale patří i boti modulární, do nichž mohou ostatní vývojáři přidávat vlastní funkcionalitu.
	
	Specifickou vlastností Matrixu jsou mosty (\textit{bridges}). Ty umožňují propojit místnost s jinou platformou včetně  Discordu a Slacku. Chat z platformy třetí strany by se pak měl zrcadlit s vybranou místností. Uživatelé z jiné platformy mají v Matrix místnosti svou reprezentaci zvanou \textit{ghost}. Pokud to daná platforma podporuje, tak v jejím ekvivalentu místnosti budou uživatelé ze strany Matrixu reprezentováni jako tzv. \textit{puppets}. \cite{doc_Matrix}
	
	\subsection{Microsoft Teams}
	
	Microsoft Teams je, stejně jako Slack, platforma pro firemní komunikaci. Každý účet na Teams náleží jedné organizaci a obvykle se do něj přihlašuje přes firemní e-mail. Organizace se pak dělí na týmy, které se mohou dělit na kanály. Tým je kolekce uživatelů, která by měla reprezentovat určitý celek v dané organizaci (např. lidé pracující na konkrétním projektu). Kanály jsou sekce svého týmu, ve kterých probíhá komunikace ve formě příspěvků a komentářů. Klasický textový chat s případným hlasovým hovorem probíhá v samostatné sekci a umožňuje se spojit i s uživateli z jiné organizace.
	
	Podobně jako u Slacku se zdejší aplikace zaměřují především na zvýšení produktivity a propojení Teams s dalšími službami. Bot je v Teams terminologii aplikace vykonávající repetitivní úkony, která se může účastnit konverzace v chatu nebo kanálu. Boti se tvoří v oficiálním SDK, které je dostupné pro jazyky C\#, JavaScript a Python.
	
	Na konci roku 2023 bylo představeno Microsoft Copilot Studio, které mimo jiné podporuje tvorbu Teams botů pomocí grafického rozhraní bez psaní zdrojového kódu. Pro tento typ botů není potřeba vlastní hosting.
	
	Platforma Teams je součástí předplatného Microsoft 365. Existuje i bezplatná verze, ta má ale omezenou funkcionalitu a nedovoluje integraci aplikací včetně botů. Kromě Teams pro firmy byla později představena verze pro domácnosti. Ta by měla sloužit pro komunikaci s rodinou a přáteli. Většina funkcí je v této verzi vypnuta. Místo týmů jsou zde tzv. komunity, které se chovají totožně, pro jejich správu je ale nutné použít mobilní aplikaci.
	
	\subsection{Flock}
	
	Flock je platforma pro firemní komunikaci, která podle svého webu nabízí oproti konkurenčnímu Slacku a Teams více funkcí za méně peněz. Tento web obsahuje výčet více jak sta vlastností, ve kterých je Flock údajně lepší než konkurence. Po bližším průzkumu je ale zjevné, že některá uvedená tvrzení jsou nepravdivá nebo zavádějící.
	
	Např. je zde uvedeno, že do Slacku se nelze přihlásit pomocí účtu Google, soukromý Slack kanál nejde přepnout na veřejný a ve Slacku není k dispozici UI pro spravování seznamu úkolů. Během testování platformy Slack byla tato tři tvrzení prověřena a žádné z nich není pravdivé. Platforma Flock byla i přesto do rešerše zahrnuta, protože podporuje tvorbu botů a objevuje se v několika webových článcích typu \textit{nejlepší platformy pro komunikaci}.
	
	Struktura Flocku je podobná jako u ostatních platforem: Jednotlivé servery se nazývají týmy a obsahují textové kanály, ve kterých je možné zahájit hlasový hovor. Zdejší aplikace komunikují s Flock API a boti jsou jejich uživatelské reprezentace. Výběr aplikací je podobný jako u platforem Slack a Teams.
	
	Platforma pro vývoj Flock aplikací se nazývá FlockOS a má slogan ,,World's First Chat Operating System``, s operačním systémem ale nemá nic společného. Boty lze programovat v oficiálním SDK, jehož poslední verze ale vyšla v roce 2017.
	
	\subsection{Mattermost, Rocket.Chat a Zulip}
	
	Mattermost, Rocket.Chat a Zulip jsou komunikační platformy s otevřeným zdrojovým kódem. Díky tomu je možné provozovat tyto platformy na vlastních strojích (self-hosting), což je vhodné pro firmy, které díky tomu mají všechna data z chatů uložena u sebe. Všechny tři platformy ale nabízí i svůj hosting v několika úrovních měsíčního předplatného. Struktura těchto programů se pak podobá Slacku.
	
	Mattermost nemá žádnou knihovnu pro tvorbu botů, veškerou logiku komunikace s jejich API tedy musí zajistit vývojář bota. Pro Rocket.Chat je možné vyvíjet boty v oficiálním JavaScript SDK, nebo je vytvořit v grafickém rozhraní na platformě Botpress. Zulip má pro vývoj botů k dispozici oficiální Python knihovnu.
		
	\chapter{Matematika na platformě Discord}\label{Chapter3}
	
	Ze zkoumaných sociálních platforem má Discord nejkomplexnější a nejlépe zdokumentovaný ekosystém botů. Kolem tvorby těchto botů vznikla početná komunita a existuje pro ni tedy i nejvíce knihoven. Discord nemá žádné specifické zaměření (jako firemní nebo herní) a díky tomu pokrývá širokou škálu uživatelů. Proto byla pro tvorbu matematického bota vybrána právě tato platforma.
	
	Ačkoliv nebyl Discord vytvořen pro účely výuky a nemá žádné speciální matematické nástroje, \textit{vzdělávání} je jednou z pěti hlavních kategorií veřejných Discord serverů a patří do ní i servery specializované na matematiku. \textit{Mathematics} je nejpopulárnější server s tímto zaměřením, na kterém mohou uživatelé diskutovat a řešit matematické problémy různých úrovní složitosti.
	
	Na serveru je také automatický systém přiřazování textových kanálů uživatelům s konkrétním matematickým problémem. Ostatní uživatelé se v daném kanále mohou pokusit zadaný problém vyřešit. Jakmile je zadavatelova otázka zodpovězena, textový kanál se může použít pro problém dalšího uživatele. O logiku přiřazování kanálů se stará místní bot.
	
	Matematicky zaměřených Discord botů není mnoho. V oficiálním adresáři aplikací nebyl během rešerše nalezen žádný. V neoficiálních databázích pak sice bylo nalezeno několik desítek botů, kteří se podle popisu alespoň částečně zabývají matematikou, velká část z nich ale byla offline a neměla k dispozici zdrojový kód. Otestováno bylo tedy nakonec 11 botů, které lze zařadit do dvou kategorií.
	
	\section{Bot vykreslující matematické výrazy}\label{_tag_section_texbot}

	Jelikož Discord nemá žádnou podporu pro vykreslování matematických výrazů, což je v textové konverzaci ohledně matematiky velmi užitečné, existuje hned několik botů s touto funkcionalitou. Konkrétně vykreslení umožňuje 5 z 11 testovaných botů. K popisu výrazu se ve všech případech používá TeX syntax, ve které je zadán vstupní parametr vykreslovacího příkazu. Bot pak podle parametru vygeneruje obrázek s matematickým výrazem a odešle ho do textového kanálu, kde byl příkaz zadán.
	
	Dva zkoumaní boti mají možnost zapnout automatické vykreslování: Jakmile jakákoliv odeslaná zpráva na serveru obsahuje dvakrát symbol dolaru, bot celou tuto zprávu vykreslí do obrázku a text mezi dolary nahradí matematickým zápisem (obrázek \ref{_tag_img_autotex}). Tři boti pak umožňují změnit barevné schéma generovaných obrázků. Je vhodné, aby tyto obrázky neměly průhledné pozadí, jinak by např. uživatelé používající světlý motiv Discordu nemohli přečíst text v obrázcích s bílou barvou písma na průhledném pozadí.
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=\textwidth]{img/AutoTeX}
		\caption{Automatické vykreslení matematického výrazu}
		\label{_tag_img_autotex}
	\end{figure}
	
	U botů psaných v jazyce JavaScript lze pro implementaci této funkcionality využít knihoven KaTeX a MathJax. V jazyce Python to pak umožňuje balík Matplotlib, který ale sám o sobě neumí vykreslovat složitější prvky jako např. matice. K tomu je potřeba, aby na stroji, kde je bot spuštěn, byla nainstalována LaTeX distribuce, která se pak použije namísto výchozího Matplotlib vykreslování. Další možností nezávislou na použitém jazyku a knihovně je využít pro vykreslení nějakou externí službu.
	
	\section{Bot jako kalkulačka}
	
	Celkem devět otestovaných botů disponuje příkazy pro výpočet jednoduchých příkladů. V lepším případě se jedná o jeden příkaz typu \textit{vypočti}, kterému se jako vstupní parametr zadá příklad s různými operacemi včetně závorek, goniometrických funkcí apod. Výstupem takového příkazu je výsledek celého výrazu. Méně praktickou variantou jsou pak boti se sadou příkazů pro různé operace typu \textit{sečti}, \textit{vynásob}, \textit{vypočti sinus} apod. Vstupem těchto příkazů je buď jedno, nebo více čísel.
	
	Kromě výpočtu numerických příkladů se také objevují příkazy např. pro úpravy výrazů, derivace apod. Sedm botů pak dokáže vygenerovat obrázek s jednoduchým grafem dle zadaného předpisu. Dva boti umí zadat uživatelův vstup do služby Wolfram Alpha a do chatu odeslat její výstup.
	
	Jeden bot dokáže generovat náhodné příklady, jedná se ale pouze o čtyři základní binární operace. Tedy např. $x+y$, kde $x$ a $y$ jsou v rozmezí 1 až 99. Bot postupně generuje sérii deseti příkladů a uživatel má u každého deset vteřin na zadání výsledku. Po dokončení série příkladů je pak uživateli zobrazeno jeho skóre.
	
	% \section{DAS} ?
	
	\chapter{Prostředky pro tvorbu Discord botů}\label{Chapter4}
		
	Discord API, se kterým program ovládající bota komunikuje, se dělí na dvě hlavní vrstvy: Pro obecné operace slouží HTTPS REST API a pro odesílání a přihlašování k událostem v reálném čase se používají trvalá zabezpečená připojení pomocí protokolu WebSocket. Samotná komunikace pak probíhá ve formátu JSON a pro unikátní identifikátory všech objektů se využívá formát Twitter Snowflake ID. \mbox{Discord} operuje na tak velkém měřítku, že zajistit úplnou konzistenci jeho dat by bylo nemožné, a proto je většina operací v Discord API eventuálně konzistentní. \cite{doc_Discord}
	
	Eventuální konzistence znamená, že distribuovaná a replikovaná databáze povoluje relativně velké množství nekonzistentních dat. Pokud ale po nějaký čas neproběhne operace zápisu, tak se data na všech replikách postupně ,,srovnají``. \cite{book_distributedSystems4}
	
	Tvorba aplikací pracujících nad eventuálně konzistentními daty může být náročná. Události z Discord API navíc nemusí klientovi vždy přijít právě jen jednou, a proto je na ně nutné reagovat idempotentně. Výsledek několikrát provedené idempotentní operace by měl být stejný, jako kdyby byla provedena jen jednou. \cite{book_distributedSystemsUnderstanding}
	
	Z důvodu usnadnění tvorby Discord botů začaly pro tento účel vznikat komunitní knihovny. Oficiální dokumentace jich zmiňuje celkem 21 pro 11 různých programovacích jazyků. Tato kapitola blíže představuje některé z těchto knihoven, ve kterých byl v rámci rešerše implementován jednoduchý příkaz pojmenovaný \textit{pow}. Ten přijímá dva celočíselné parametry, se kterými provede umocňování. Ke zprávě s výsledkem je ještě přidáno tlačítko odkazující na webovou stránku (viz příloha \ref{Appendix3}).
	
	\begin{table}[ht]
		\centering
		\caption{Nejpopulárnější knihovny pro tvorbu Discord botů}\medskip
		\begin{threeparttable}
			\rowcolors{2}{gray!10}{}
			\begin{tabular}{ l l c c r }
				\textbf{Název} & \textbf{Jazyk} & \textbf{Vznik} & \textbf{Oficiální tutoriály} & \textbf{Popularita}\tnote{*} \\\hline
				discord.js	& JavaScript & 2015 & Ano & 24 452 \\
				discord.py	& Python	 & 2015 & Ne  & 14 024 \\
				DiscordGo	& Go		 & 2015 & Ne  &  4 563 \\
				serenity	& Rust		 & 2016 & Ne  &  4 259 \\
				JDA			& Java		 & 2015 & Ano &  4 038 \\
				Discord.Net & C\#		 & 2015 & Ano &  3 165 \\
				Pycord		& Python	 & 2021 & Ano &  2 619 \\
				Discord4J	& Java		 & 2015 & Ano &  1 697 \\
				Eris		& JavaScript & 2016 & Ne  &  1 465 \\
				DSharpPlus	& C\#		 & 2016 & Ano &  1 179 \\
			\hline\end{tabular}
			\begin{tablenotes}
				\item[*] počet GitHub hvězd ke dni 15. 2. 2024
			\end{tablenotes}
		\end{threeparttable}
	\end{table}
	
	\section{discord.py}\label{_tag_section_discordpy}
	
	Discord.py je knihovna pro tvorbu Discord botů v jazyce Python, která je distribuována v podobě balíku instalovaného programem pip. Pro definici veškeré funkcionality bota se využívá klíčových slov \verb|async| a \verb|await|. Bot je zde instancí předdefinované třídy s metodami, které se spouští při určité události a jejichž tělo lze dodefinovat. Pro přiřazení metod ke konkrétní události se často používají dekorátory, což je syntax umožňující upravit chování metod bez zásahu do jejich těla.% Některé části discord.py (např. interaktivní prvky nebo tzv. \textit{cogs}) pak využívají objektového návrhu. 
	
	Pomocí tzv. cogs lze rozdělit logiku bota do více tříd, které dědí z třídy \textit{Cog} definované knihovnou. Každá taková třída je v discord.py terminologii zvaná cog a slouží jako kolekce souvisejících metod, které buď obsluhují příkazy, nebo reagují na události. Zvykem je, aby se každý cog nacházel ve zvláštním souboru a aby se každý z těchto souborů nacházel v adresáři pojmenovaném \textit{cogs}. Instance cog tříd jsou pak do bota nahrány nikoliv přes importování, ale pomocí mechanismu rozšíření (\textit{extensions}), který knihovna přidává. Za běhu programu je možné rozšíření přidávat a odebírat bez nutnosti restartování (\textit{hot reload}).
	
	Výhodou discord.py je jeho velká komunita, od které lze získat podporu např. na webu Stack Overflow nebo na oficiálním Discord serveru této knihovny. Díky použití jazyka Python a dekorátorů je psaný kód čitelný a zároveň má vysokou hustotu. Pro definici příkazů lze navíc využít anotací a komentářů u příslušných metod. Knihovna má k dispozici referenční příručku, která stručně popisuje veškerou její funkcionalitu. Podrobnější popisy nebo příklady použití se zde ale vyskytují jen zřídka.
	
	Největším problémem discord.py je podle hlasování uživatelů na GitHub \mbox{Issues} absence oficiálních tutoriálů. Referenční příručka je dobrým nástrojem hlavně pro programátory, kteří už obecnou tvorbu botů v této knihovně ovládají, a neobsahuje např. informace o tom, jak strukturovat větší projekt, nebo co znamenají jednotlivé funkce knihovny z pohledu koncového uživatele.
	
	V roce 2021, kdy byly mimo jiné představeny podpůrné příkazy, vyšla nová verze Discord API, která přinesla zásadní změny v jeho používání. To vedlo k frustraci autorů některých knihoven a vývoj discord.py byl pozastaven. Po šesti měsících se repozitář opět otevřel a vývoj mohl pokračovat, mezitím ale vzniklo několik nových knihoven založených na discord.py (konkrétně Pycord, Nextcord a disnake). Zároveň začaly vycházet balíky, které do existující knihovny přidávaly podporu pro novou verzi Discord API. Zdrojové kódy těchto knihoven jsou si velmi podobné, a proto je při hledání informací nutné dávat pozor na to, s jakou knihovnou daný zdroj pracuje.
	
	\section{discord.js}
	
	Discord.js je knihovna pro běhové prostředí Node.js umožňující tvorbu Discord botů v jazycích JavaScript a TypeScript. Funkcionalita je založena na objektech \verb|Promise| a při psaní kódu se využívá tzv. arrow funkcí. Režie pro zprovoznění podpůrných příkazů a modularity (zde ve stylu \textit{co soubor, to příkaz}) je o něco složitější než u discord.py.
	
	Velkou výhodou této knihovny je existence oficiálních tutoriálů, které programátora provedou krok za krokem od úvodní instalace npm balíčku až po tvorbu pokročilých příkazů. Krom popisu postupů a zdrojových kódu se díky tomuto návodu programátor rychle dozví, co všechno do svého bota vlastně může implementovat. Nechybí ani referenční příručka a početná komunita jako u discord.py.
	
	Knihovna nevyužívá dekorátorů ani komentářů pro definování příkazů. Výsledný kód obsahuje mnoho vnořených nebo zřetězených funkcí, kvůli kterým může být delší a hůře čitelný. Knihovna sice podporuje TypeScript, oficiálních ani komunitních návodů pro jeho korektní použití ale není mnoho.
	
	\section{Discord.Net}
	
	Discord.Net je knihovna pro tvorbu Discord botů na platformě .NET, kterou lze do projektu přidat přes systém NuGet. Dokumentace je psaná pro jazyk C\#, ve kterém je tato knihovna implementována. Pro tvorbu bota je ale možné použít i jiné jazyky z této platformy jako F\# a Visual Basic. Knihovna má k dispozici referenční příručku i tutoriály, její nevýhodou je menší komunita.
	
	 Pro tvorbu složitějších botů se doporučuje použít vkládání závislostí\footnote{Vkládání závislostí (\textit{dependency injection}) je návrhový vzor, kde se třetí strana stará o vztahy mezi komponentami a jejich závislostmi \cite{lit_distributedSystems}. Konkrétně jde o to, aby byla za běhu programu do vybraných atributů dosazena správná instance.}. Oproti předchozím knihovnám Discord.Net u podpůrných příkazů odděluje logiku jejich synchronizace a obsluhy. Kód zde tedy není strukturován na metody odpovídající jednotlivým příkazům, ale všechny příkazy jsou obsluhovány jedinou metodou, ve které je kód dále rozvětven\footnote{Podpůrné příkazy musí být synchronizovány, aby je mohli uživatelé používat. V discord.py a discord.js jsou všechny potřebné informace pro synchronizaci (jméno, popis a vstupní parametry) součástí definice obslužné funkce daného příkazu. V Discord.Net jsou tyto informace uvedeny ve speciální metodě pro synchronizaci. Druhá speciální metoda pak obsluhuje všechny příkazy. Obvykle je uvnitř druhé metody rozvětvení typu \textit{switch} podle jména příkazu.}.
	
	\section{JDA}
	
	JDA je knihovna pro tvorbu botů v jazycích Java a Kotlin. Do projektu je přidána buď pomocí nástroje Maven, nebo Gradle. Stejně jako u Discord.Net je zde oddělená logika synchronizace podpůrných příkazů s Discordem od jejich samotné obsluhy.
	
	Referenční příručka JDA je vygenerována přes Javadoc, což může být vhodné pro programátory zvyklé na jazyk Java, na první pohled ale působí složitě a nepřehledně. K dispozici jsou také tutoriály včetně ukázkové implementace bota přehrávajícího hudbu v hlasovém hovoru. Ze čtyř zkoumaných knihoven se jedná o jedinou, která by takto v návodu obsahovala krok za krokem kompletní proces tvorby bota s konkrétním zaměřením.
	
	\chapter{Tvorba matematického Discord bota}\label{Chapter5}
	
	Tato kapitola popisuje tvorbu matematického Discord bota, který byl pojmenován \textit{LingeBot}. Zaměřuje se na výklad teorie a generování příkladů z lineární algebry. K výkladu této látky lze přistupovat s různou mírou obecnosti: Některé zdroje prezentují lineární algebru jako sadu postupů pro řešení určitých matematických úloh, jiné ji vykládají jako teorii vektorových prostorů a lineárních zobrazení \cite{lit_lingebra}. Bot byl vytvořen spíše pro prezentování informací z druhé zmíněné strany spektra, avšak jeho návrh obecně podporuje jakýkoliv typ matematických materiálů. Generované příklady se pak soustředí na základní výpočty s maticemi.
	
	Pro tvorbu bota byla zvolena knihovna discord.py zejména kvůli její početné komunitě a čitelnosti výsledného zdrojového kódu. Při volbě také hrála roli existence matematických knihoven pro jazyk Python (konkrétně Matplotlib, NumPy, SciPy a SymPy), které jsou zavedené a dobře zdokumentované.
		
	\section{Návrh}
	
	\subsection{Vykreslování matematických výrazů}
	
	Jak již bylo zmíněno v sekci \ref{_tag_section_texbot}, pro textovou komunikaci ohledně matematiky je vhodné používat správné matematické symboly. Příkladem je situace, kdy chce jeden uživatel odeslat a popsat druhému uživateli vzorec obsahující mocniny (např. $x^2$). Pokud si uživatel nepamatuje specifický alt kód, pak symbol ,,$^2$`` není možné na klávesnici napsat. Ne příliš praktickým řešením je najít a zkopírovat daný symbol buď z internetu, nebo programu jako je \textit{mapa znaků}. Další možností je zavést alternativní značení, tedy např. místo $x^2$ psát $x$\textsuperscript{$\wedge$}2 nebo $x$**2. Tato značení ale nejsou nijak normalizovaná a v textové konverzaci zejména více uživatelů mohou vést k nedorozuměním. Obě možnosti navíc selhávají ve chvíli, kdy je potřeba zapsat buď velké množství různých symbolů, nebo složitější výrazy obsahující zlomky, matice atd. Některá textová prostředí podporují vykreslování HTML: Pro horní a dolní index lze využít značek \verb|sup| a \verb|sub|, řecká písmena lze pak psát např. jako \verb|&alpha;|. Pro jakýkoliv složitější matematický výraz je ale jediným zavedeným způsobem program TeX a jeho syntax.
	
	Protože Discord vykreslování TeX výrazů nepodporuje, jedná se o jednu z funkcionalit navrhovaného bota. Konkrétně jde o příkaz \verb|/render| (\textit{vykresli}), jehož parametrem je právě matematický výraz zapsaný v TeX (resp. Matplotlib Mathtext) syntaxi, který má být vykreslen. Po spuštění příkazu je do chatu odeslán obrázek obsahující vykreslení požadovaného výrazu. Pod tímto obrázkem se nachází trojice tlačítek \textit{Potvrdit}, \textit{Upravit} a \textit{Smazat}. Tlačítko pro smazání kompletně odstraní botem odeslanou zprávu. Tlačítkem pro úpravu se vyvolá vyskakovací okno s textovým polem, ve kterém je předvyplněn uživatelův původní vstup. Po opravě nebo rozšíření výrazu je daný obrázek překreslen. Pokud se ve vstupu od uživatele nachází chyba, pak zpráva místo obrázku obsahuje výpis z chybového hlášení, díky kterému může uživatel chybu snadněji detekovat. Tlačítko potvrzení pouze nechá trojici tlačítek zmizet a tedy znemožní výraz dále upravovat nebo ho smazat. Tato akce se po určitém časovém intervalu provede automaticky, aby tlačítka zbytečně neznepřehledňovala textovou konverzaci.
	
	Vykreslování matematických výrazů je stěžejní funkcionalitou navrhovaného bota. Kromě příkazu \verb|/render| totiž může být použito i během výkladu teorie nebo při zobrazování vygenerovaných příkladů.
	
	\subsection{Výklad teorie}
	
	Výklad teorie funguje na principu odesílání zpráv obsahujících předem připravené výpisky z určitého tématu. Je dostupný pod příkazem \verb|/explain| (\textit{vysvětli}), po jehož zadání je uživateli zobrazen výběrový seznam všech dostupných témat. Každé téma odpovídá jednomu textovému souboru, díky tomu nejsou výpisky součástí zdrojového kódu a snadněji se upravují. Obsah souborů je psaný v jazyce Markdown, který Discord v textových zprávách podporuje a tedy umožňuje jejich formátování.
	
	Jazyk Markdown nemá žádný oficiální styl zápisu pro označení matematických výrazů, zvykem ale je výraz uzavřít z obou stran řetězcem tvořeným dvěma symboly dolaru (,,\verb|$$|``, dále jen ,,dvoudolar``). Pokud se tedy ve výpiscích nachází text ohraničený dvoudolary, pak je tato část do textového kanálu odeslána ve formě obrázku podobně jako u příkazu \verb|/render|. Maximální délka odeslané zprávy na Discordu je 2000 znaků, a proto je bot schopen odesílané výpisky rozdělit do více zpráv. %Rozdělování do více zpráv je nutné právě i pro kombinování zpráv textových a těch obsahující obrázek.
	
	Každé teoretické téma se dělí na několik podtémat, jejichž názvy a obsah jsou určeny podle nadpisů druhé úrovně v Markdown souboru. Po zvolení tématu z výběrového seznamu je do chatu odeslán seznam příslušných podtémat, mezi kterými lze přepínat pomocí tlačítek \textit{Další} a \textit{Předchozí}. V textovém kanálu se tedy vždy nachází zprávy patřící k aktuálně vybranému podtématu, které jsou po stisknutí jednoho z tlačítek smazány a nahrazeny novými. K flexibilnějšímu přepínání mezi podtématy byl přidán další výběrový seznam, z něhož lze vybrat jakékoliv podtéma bez nutnosti procházet je popořadě jako při použití tlačítek. Dalšími tlačítky u rozhraní výkladu teorie jsou \textit{Odeslat do DMs} (přepošle uživateli zprávy k danému podtématu do přímých zpráv), \textit{Ukončit} (nechá zmizet tlačítka, odeslané zprávy zůstanou) a \textit{Ukončit a smazat} (tlačítka i zprávy jsou odstraněny). Pokud konverzace s botem již probíhá v přímých zprávách (namísto serveru), pak tlačítko \textit{Odeslat do DMs} není dostupné.
	
	Během návrhu se původně uvažovalo o možnosti nahrávání nových témat uživateli. Discord umožňuje jako parametr příkazu předat soubor a uživatel by takto mohl do bota nahrát vlastní Markdown zápisky. Tento návrh ale otevírá několik otázek: Budou si moct nahrané zápisky zobrazit všichni uživatelé, nebo jen členové stejného serveru? Má být nastaven limit maximálního počtu nahraných souborů na konkrétního uživatele, nebo na server? Jak se stavět k nevhodnému obsahu? Navíc by bylo potřeba rozhraní, kde by uživatel mohl své nahrané soubory spravovat. To by v prostředí textového chatu nebylo příliš praktické, vhodnější by bylo k botu ještě vytvořit webové rozhraní.
	
	Nakonec byl zvolen přístup, kde si každý uživatel může provozovat vlastní instanci navrhovaného bota. Soubory s tématy jsou pak nakopírovány do vyhrazeného adresáře, odkud mohou být snadno spravovány. %TODO jak?
	
	\subsection{Generace příkladů} % kalkulačka zavržena
	
	Příklady lze generovat použitím příkazu \verb|/generate|, po jehož zadání je do textového kanálu opět odeslán výběrový seznam, který tentokrát obsahuje dostupné kategorie příkladů. Po volbě některé z kategorií se objeví trojice tlačítek \textit{Generovat příklad}, \textit{Jak počítat?} a \textit{Změnit kategorii / Ukončit}. Po vygenerování příkladu jej bot bez výsledku odešle do chatu. Uživatel si může zkusit příklad vypočítat, a poté si nově objeveným tlačítkem nechat zobrazit výsledek. Tento proces lze opakovat, dokud není rozhraní ukončeno.
	
	Navrhovaný bot neobsahuje funkcionalitu pro kontrolu uživatelem zadaných výsledků. Pokud by takovým výsledkem byla např. matice většího rozměru, její zadávání by bylo zdlouhavé a náchylné na překlepy. Muselo by také mít nastavená jasná pravidla zápisu, nebo by uživatelský vstup musel projít komplexnější syntaktickou analýzou. Pokud se uživatel dozví, že jeho výsledek je nesprávný, dalším krokem by mělo v každém případě být nalezení chyby a poučení se z ní. Znalost výsledku sice může hledání chyby trivializovat, avšak frustrace z nesprávných výsledků u uživatelů pravděpodobně stejně vede k okamžitému zobrazení těch správných.
	
	Po stisknutí tlačítka \textit{Jak počítat?} jsou do textového kanálu odeslány zprávy s návodem pro výpočet příkladů z dané kategorie. Logika odesílání těchto zpráv je stejná jako u výkladu teorie. Obsah je tedy čerpán z Markdown souborů, které lze snadno upravovat, a nechybí tlačítko pro přeposlání návodu do přímých zpráv. Každá kategorie příkladů nemusí nutně obsahovat návod, pak je tlačítko pro jeho zobrazení zašedlé a nelze s ním interagovat. Opačný stav, kdy existuje pouze návod a nelze generovat příklady, je také možný. % TODO (???)
		
	\subsection{Možnosti moderace}
	
	Aby byly demonstrovány specifické vlastnosti platformy Discord, byla do bota přidána funkcionalita pro moderaci (administraci) pomocí sady příkazů \verb|/setup|. Administrátoři serveru mohou u každého příkazu nastavit, kdo má oprávnění jej používat. Lze vybrat ze tří kategorií: pouze administrátoři, administrátoři a moderátoři bota, nebo kdokoliv (výchozí stav). Tato nastavení dávají smysl pouze při používání bota na serverech a v přímé konverzaci nemají význam.
	
	\textit{Administrátor} je typ oprávnění, které je součástí Discordu a uživatelům ho lze přidělit v rámci role. Pokud není taková role nikomu přidělena, pak je majitel serveru jediným uživatelem s těmito právy a zároveň jediným, kdo může tuto roli někomu dalšímu přidělit.
	
	Za ,,moderátora bota`` je považován uživatel, kterému byla administrátorem přidělena speciální role s názvem \textit{LingeMod}. Tato role je vytvořena navrhovaným botem po jeho připojení na nový server. Díky moderátorské roli lze uživatele bez administrátorských práv rozdělit na dvě skupiny a pouze jedné z nich povolit používání určitých příkazů.
	
	Nastavení může vypadat např. následovně: Kdokoliv může vykreslovat matematické výrazy pomocí \verb|/render|, pouze moderátoři bota (a tedy i administrátoři, kteří jim jsou nadřazeni) mohou generovat příklady pomocí \verb|/generate| a pouze administrátoři mohou používat výklad teorie příkazem \verb|/explain|.
	
	Podobná oprávnění lze nastavit i u tlačítek a výběrových seznamů, které jsou součástí botem odeslaných zpráv. Ve výchozím stavu s nimi může interagovat pouze uživatel, na něhož je zpráva s interaktivními prvky mířena, tedy zadavatel daného příkazu. Interakci s ,,cizími`` ovládacími prvky je ale možné povolit jakémukoliv administrátorovi nebo i moderátorovi bota. Tlačítko pro přeposlání podtématu do přímých zpráv je vždy dostupné všem.
	
	\subsection{Další funkcionalita} % $> old_commands
	
	Navrhovaný bot obsahuje příkaz \verb|/help| pro zobrazení stručné nápovědy. Zvykem při tvorbě Discord botů je také přidání příkazu \verb|/ping|, pomocí kterého lze otestovat, zdali je bot online. Příkaz ping je inspirován stejnojmenným programem a odpověď na něj obvykle vypisuje dobu odezvy (latenci) daného bota. V tomto případě byly do výpisu přidány i další informace jako doba provozu (uptime) nebo počet serverů, na kterých se navrhovaný bot nachází.
	
	Dalším přidaným příkazem, který byl inspirován prostředím příkazové řádky, je \verb|/clear|. Po jeho zadání bot do chatu odešle  prázdnou zprávu, která je tak dlouhá, aby se všechny předchozí zprávy již nevešly na obrazovku. To může být užitečné pro zpřehlednění konverzace v daném textovém kanálu.
	
	U bota je možné změnit barevné schéma vykreslovaných matematických výrazů. Konkrétně jsou k dispozici čtyři kombinace barvy písma a pozadí u odeslaných obrázků. Barevné schéma je vázané na server a může být přenastaveno jeho administrátorem. Všechny botem odeslané obrázky na určitý server budou respektovat jeho nastavené schéma nezávisle na uživateli příkazu. Uživatel si totiž může nastavit barevné schéma pro konverzaci s botem v přímých zprávách. To je použito u zpráv reagujících na příkazy spuštěné v přímé konverzaci a zároveň u zpráv přeposlaných z jakéhokoliv serveru pomocí tlačítka \textit{Odeslat do DMs}.
	
	\section{Implementace}
	
	\subsection{Struktura projektu}

	Před implementací jednotlivých funkčních částí výsledného bota bylo nutné rozhodnout, jak bude projekt strukturován. U knihovny discord.py je toto rozhodnutí ponecháno především na vývojáři. Dokumentace knihovny neobsahuje doporučený způsob, jak kód bota rozdělovat do více souborů, ani ukázku většího projektu, kterým by se dalo inspirovat.
	
	Zvyk ohledně cog souborů (\ref{_tag_section_discordpy}) byl během implementace bota dodržen. Logika vykonání příkazů ale byla ve většině případů oddělena do jiných souborů, které se v pomyslné hierarchii projektu nachází na jiné úrovni. Cogs je pak importují a pouze volají jejich metody. Podle toho, zdali jsou tyto ,,jiné`` soubory závislé na knihovně discord.py, je lze rozdělit do dvou skupin.
	
	Soubory, jež Discord knihovnu importují, ale nejedná se o cogs, se nachází v adresáři \textit{d\_modules}. Je v nich implementována logika, která je společná pro více příkazů, jako je kontrola oprávnění pro spuštění příkazu a práce s textovými zprávami. Zároveň se zde nachází veškerá logika pro obsluhu interaktivních prvků jako tlačítek a vyskakovacích oken, ale i modul obsahující definici samotného bota.
	
	Druhá skupina souborů, které knihovnu discord.py neimportují, se nachází v adresáři \textit{utils}. Metody těchto modulů jsou používány především v \textit{d\_modules} pro společnou funkcionalitu, která je nezávislá na Discordu. Tyto moduly naopak importují knihovny jako sqlite, Matplotlib a SymPy. Starají se tedy o práci s databází, vykreslování matematických výrazů a generování příkladů. % šly by teoreticky použít v jiné aplikaci, problems dostaly vlastní adresář a balík(?)
	
	Vedle těchto adresářů se ještě nachází soubory \textit{config.json} (uložení tokenu bota), \textit{db\_init.py} (vytvoření databáze), \textit{run.py} (spuštění bota) a adresáře \textit{\_database}, \textit{\_logs} a \textit{\_static}. Adresář \textit{\_static} obsahuje Markdown soubory s výpisky z teorie a návody pro počítání příkladů. % nic moc odstavec
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=\textwidth]{img/ProjectStructure}
		\caption{Struktura projektu}
	\end{figure}

	\subsection{Implementace vykreslování matematických výrazů}\label{_tag_section_approxtexlen}

	První verze implementace příkazu \verb|/render| byla prostá. Pomocí balíku Matplotlib je vytvořen prázdný obrázek \textit{figure}, jehož barva odpovídá barvě pozadí Discord klienta ve výchozím nastavení. Parametr příkazu, který obsahuje předpis matematického výrazu, je do obrázku vložen jako text se zapnutým parametrem \textit{render\_math}. Balík Matplotlib se postará o správné vykreslení výrazu a obrázek je uložen do souboru, který je odeslán do textového kanálu. Později bylo ukládání do souboru nahrazeno proudem \textit{io.BytesIO}, který souborové rozhraní pouze simuluje.

	Výklad lineární algebry se neobejde bez vykreslování matic, ty ale Matplotlib Mathtext nepodporuje. Balík sice umožňuje nastavit, aby vykreslování používalo místní TeX distribuci, během implementace ale nebylo jasné, kde bude výsledný bot nasazen a jestli zde bude možné TeX nainstalovat. Vykreslování tímto způsobem je navíc pomalejší. Proto byla pro účely bota napsána vlastní logika vykreslování matic.
	
	U textu vkládaného do Matplotlib obrázku lze nastavit jeho souřadnice $x$ a $y$. Matice na vstupu vykreslovací funkce je rozdělena na své jednotlivé prvky, které jsou vykresleny zvlášť na odpovídajících souřadnicích. Pomocí úseček jsou pak vytvořeny hranaté závorky matice. Problém může nastat při určování souřadnic jednotlivých prvků v matici.
	
	Pokud jsou všechny prvky matice jednociferná čísla, pak jejich souřadnice $x$ odpovídá číslu sloupce a $y$ číslu řádku v matici. Tyto souřadnice jsou ještě vynásobeny konstantou, která určuje velikost mezery mezi jednotlivými prvky\footnote{Konstanta u souřadnic $y$ by měla být záporná, protože řádky matice jsou obvykle číslovány odshora, zatímco souřadnice v Matplotlib obrázku mají počátek vlevo dole. V této implementaci je to ale vyřešeno tak, že se jednotlivé řádky matice při vykreslování procházejí pozpátku.}. Jakmile by ale byl některý z prvků matice širší (např. trojciferné číslo), začal by se překrývat se svými sousedními prvky. Proto je potřeba přidat funkcionalitu, která dokáže zjistit šířku prvků v matici. Odsazení je pak nastaveno podle nejširšího nalezeného prvku.
	
	Šířku prvku lze určit jeho dočasným vykreslením do samostatného obrázku, u kterého jsou následně zjištěny jeho rozměry. Tento obrázek je opět uložen do proudu BytesIO, který je po zjištění šířky zahozen. Takovýto způsob není nejefektivnější zejména u vykreslování větších matic, a proto byla implementována rychlejší metoda, která šířku prvků pouze aproximuje.

	Cílem metody je pro zadaný matematický výraz v TeX syntaxi vrátit číslo, které odpovídá jeho délce. Jednotkou délky je počet vykreslených číslic. Písmo použité u vykreslovaných matematických výrazů je proporcionální a některé znaky tedy mohou být širší než jiné. Číslice jsou ale jako jediné neproporcionální, a proto byly zvoleny jako jednotka délky. Protože se jedná pouze o aproximaci, je důležité, aby metoda délku výrazu přeceňovala. Podcenění by mohlo vést k překrývání sousedních prvků matice.
		
	\begin{figure}[ht]
		\begin{lstlisting}[language=Pseudo1]
Funkce __approx_tex_len(text: str, nahradit_zlomky: bool) vrací int:
Krok 1:
	Pokud nahradit_zlomky:
		Nahraď všechny výrazy v text ve tvaru "\frac{Č}{J}"
		za výstup funkce __approx_tex_frac_replace(Č, J).
Krok 2:
	Nahraď všechny podřetězce v text,
	které začínají na "\" a končí libovolným nepísmenným znakem,
	za tříznakový řetězec "000".
Krok 3:
	Nahraď všechny znaky v text,
	které se zároveň nachází v "+-=ABCDEFGHKMNOPQRUVWXYZmw",
	za dvouznakový řetězec "00".
Krok 4:
	Odstraň všechny znaky z text,
	které se zároveň nachází v " _^{}[]".
Krok 5:
	Vrať délku upraveného řetězce text.
	
Funkce __approx_tex_frac_replace(čitatel, jmenovatel: str) vrací str:
	délka_čitatele = __approx_tex_len(čitatel, false)
	délka_jmenovatele = __approx_tex_len(jmenovatel, false)

	Vrať řetězec tvořený znaky "0"
	o délce maximum(délka_čitatele, délka_jmenovatele).
		\end{lstlisting}
		\caption{Pseudokód aproximace délky vykresleného výrazu}
	\end{figure}
	
	\newverbcommand{\h}{\color{color_cyan!95!black}}{}
	\begin{table}[ht]
		\centering
		\caption{Příklady aproximace délky vykresleného výrazu}\medskip
		\begin{tabular}{ l | l >{\columncolor{gray!10}}l l }\hline
			&&&\\[-1em]
			\textbf{Krok 1}&\verb|1+\sqrt{x}|&\verb|1+\sqrt[N]{x}|&\verb|x^2\approx|\h|\frac{123}{4}|\\
			&\verb|1+\sqrt{x}|&\verb|1+\sqrt[N]{x}|&\verb|x^2\approx|\h|000|\\\hline
			&&&\\[-1em]
			\textbf{Krok 2}&\verb|1+|\h|\sqrt|\verb|{x}|&\verb|1+|\h|\sqrt|\verb|[N]{x}|&\verb|x^2|\h|\approx|\verb|000|\\
			&\verb|1+|\h|000|\verb|{x}|&\verb|1+|\h|000|\verb|[N]{x}|&\verb|x^2|\h|000|\verb|000|\\\hline
			&&&\\[-1em]
			\textbf{Krok 3}&\verb|1|\h|+|\verb|000{x}|&\verb|1|\h|+|\verb|000[|\h|N|\verb|]{x}|&\verb|x^2000000|\\
			&\verb|1|\h|00|\verb|000{x}|&\verb|1|\h|00|\verb|000[|\h|00|\verb|]{x}|&\verb|x^2000000|\\\hline
			&&&\\[-1em]
			\textbf{Krok 4}&\verb|100000|\h|{|\verb|x|\h|}|&\verb|100000|\h|[|\verb|00|\h|]{|\verb|x|\h|}|&\verb|x|\h|^|\verb|2000000|\\
			&\verb|100000x|&\verb|10000000x|&\verb|x2000000|\\\hline
			&&&\\[-1em]
			\textbf{Krok 5}&7&9&8\\\hline
			&&&\\[-1em]
			\textbf{Porovnání}&$1+\sqrt{x}$&$1+\sqrt[N]{x}$&$x^2\approx\frac{123}{4}$\\
			&$1234567$&$123456789$&$12345678$\\
		\hline\end{tabular}
	\end{table}
	
	Aproximovaná délka vykresleného výrazu odpovídá počtu znaků vstupního řetězce po tom, co je na něm provedeno několik úprav. Kroky 2 a 3 nahrazují určité části textu řetězcem s dvěma (třemi) nulami. To, že je nahrazujícím znakem nula, není podstatné. Důležitá je délka těchto řetězců. Následující krok odebere řídící znaky a mezery, které se nevykreslují. Poté už je vrácena délka řetězce.
	
	Krok 2 pokrývá příkazy jako \verb|\sqrt| a \verb|\approx|. Ne všechny tyto symboly jsou dlouhé jako tři číslice. Extrémním případem je příkaz \verb|\iota|, který je dokonce kratší než jediná číslice. Jak již ale bylo zmíněno, délku je lepší přecenit nežli podcenit. Krok 3 nahrazuje znaky, u kterých bylo zjištěno, že jsou delší než jedna číslice. Jedná se především o velká písmena, ale patří sem i znaky jako plus a minus.
	
	Při určování délky jsou problémové zlomky psané jako \verb|\frac{Č}{J}|. V nejhorším případě, pokud je délka čitatele \textit{\texttt{Č}} i jmenovatele \textit{\texttt{J}} stejně dlouhá, by byla šířka zlomku vyhodnocena jako dvojnásobek té skutečné. Proto byl přidán krok 1, ve kterém se metoda rekurzivně volá na všechny zlomky ve vstupním řetězci. Ty jsou pak nahrazeny řetězcem o aproximované délce jejich čitatele, nebo jmenovatele. Vybrán je ten delší z nich.

	Stejný problém jako zlomky také způsobují kombinační čísla \verb|\binom{N}{K}|, ta se ale běžně v maticích nenachází. Krok 2 původně nahrazoval pouze dvouznakovým řetězcem, to ale bylo málo např. pro příkazy \verb|\sin| a \verb|\cos|, které lze použít pro popis matice rotace. Proto byla délka zvýšena na tři, to je ale stále málo pro příkaz \verb|\sinh|. Popisovaná metoda by tedy stále šla vylepšovat pro mnoho dalších případů, které by mohly nastat. Vzhledem k zaměření bota by ale již všechny časté scénáře měly být pokryté.

	Jelikož je pro vykreslování matic použita vlastní implementace, bylo možné zvolit styl jejich zápisu. Pro svou přehlednost, snadné strojové zpracování a rychlost zápisu uživatelem byla zvolena syntax podobná maticím v prostředí MATLAB: Do hranatých závorek jsou postupně vypsány prvky matice oddělené čárkou a pro oddělení jednotlivých řádků se místo čárky píše středník.

	Po implementaci metod pro vykreslení základních matematických výrazů a matic bylo potřeba tyto metody zkombinovat, aby bylo možné vykreslovat rovnice obsahující více matic. Uživatelský vstup je nejprve nutné rozdělit na maticové a nematicové části (podvýrazy), pro jejichž vykreslení je pak zvolena příslušná metoda. První podvýraz je vykreslen na nulové souřadnici $x$, která se postupně zvětšuje o aproximovanou délku podvýrazu. Při rozdělování na podvýrazy je nutné ignorovat hranaté závorky u odmocnin, maticový podvýraz je totiž detekován podle hranatých závorek. Aby byl celý výraz správně vertikálně zarovnán, je potřeba předem zjistit počet řádků té nejvyšší matice a podle ní určovat souřadnici $y$ zbylých podvýrazů.
	
	Posledním krokem bylo přidání podpory pro víceřádkové výrazy zarovnané podle určitého znaku. Obvykle se zarovnává podle rovnítka. Pomocí dvou zpětných lomítek je v uživatelském vstupu označen nový řádek. Na každém řádku lze zapsat ampersand, který není vykreslen ve výsledném obrázku a značí, že následující symbol je ten zarovnávací. Každý řádek je podle ampersandu rozdělen na levou a pravou část. Obě tyto části jsou vykresleny na nulové souřadnici $x$, u té levé je ale nastaveno Matplotlib zarovnání vpravo pomocí parametru \textit{horizontalalignment}.
	
	Vlastní metoda pro vykreslování matic ale nepočítá s přenastavováním zarovnání na úrovni balíku Matplotlib. Pokud se tedy ve zpracovávaném řádku nachází matice, pak je jeho levá část zarovnána pomocí metody pro aproximaci délky výrazu: Matplotlib zarovnání je ponecháno na výchozí hodnotě (vlevo) a souřadnice $x$ je rovna záporné aproximované délce. V opačném případě, kdy se v řádku žádné matice nevyskytují, je přeskočen krok s rozdělováním na podvýrazy a rovnou se sází Matplotlib Mathtext.
	
	\subsection{View a interaktivní prvky}
	
	K odeslané zprávě s vykresleným matematickým výrazem je přidána trojice tlačítek \textit{Potvrdit}, \textit{Upravit} a \textit{Smazat}. Aby mohl být ke zprávě přidán jakýkoliv interaktivní prvek, musí být nejprve vytvořeno tzv. view. To slouží jako kontejner pro všechny interaktivní prvky a ke zprávě je přidáno přes stejnojmenný parametr. Pro definici složitější view logiky je možné vytvořit třídu, která dědí z obecného view. Do této třídy se pak přidají atributy pro uchování určitého stavu a metody pro změnu tohoto stavu. Každý interaktivní prvek má referenci na své view, díky tomu v něm lze např. po stisknutí tlačítka volat určitou metodu.
	
	Pro případy bota byla vytvořena třída \textit{LingeBotView}, která rozšiřuje obecné view. Třída uchovává referenci na zprávu, ke které je přiřazena, a na uživatele, který zadal příkaz vyvolávající tuto zprávu. Odkaz na uživatele se využívá pro kontrolu oprávnění. Odkaz na původní zprávu v tomto případě není potřeba. Z \mbox{LingeBotView} ale dědí další třídy, které se používají pro uživatelské rozhraní výkladu teorie a generace příkladů. Tyto třídy již odkaz na původní zprávu využívají. Protože se obecné view nikde jinde nepoužívá, jsou tyto třídy pro zjednodušení dále v textu nazývány jako view. 
	
	Jednotlivá tlačítka také dědí z podobné obecné třídy, u které primárně přepisují metodu \textit{callback} volanou po jejich stisknutí. Tlačítko \textit{Smazat} nevyžaduje po svém view odkaz na rodičovskou zprávu, protože si ho může získat z objektu interakce, který je metodě \textit{callback} automaticky předáván jako první parametr. Tlačítko pro úpravu matematického výrazu v sobě musí mít uložen původní uživatelský vstup, který je předvyplněn v textovém poli vyvolaného vyskakovacího okna, a barevné schéma, které bylo pro dané vykreslení použito. Vyskakovací okno po svém potvrzení volá stejnou funkci jako příkaz \verb|/render|, jen místo nové zprávy upraví tu původní. Zvolené barevné schéma se uchovává v proměnné, aby se nemuselo při každé úpravě výrazu znovu zjišťovat z databáze.
			
	% - zmínit/zjistit WEBHOOKS TOKEN EXPIRATION AFTER 15 MINUTES ?
	
	\subsection{Zpracování chyb}
	
	Pokud je za běhu bota v nějaké části kódu vyvolána výjimka, neznamená to ukončení programu. Knihovna discord.py výjimky v podstatě ignoruje. Ve výchozím nastavení jsou pouze vypsány do standardního chybového výstupu. Průběh funkce, ve které výjimka vznikla, sice není dokončen a Discord uživateli zobrazí hlášku ,,interakce se nezdařila``, bota by však tímto způsobem nemělo být možné vyřadit z provozu.
	
	Do implementovaného bota byla přidána funkce logování chyb do textového souboru. Zároveň byl vytvořen cog \textit{on\_error}, který hlásí chyby uživateli. Výjimka, která byla vyvolána z důvodu nedostatečného oprávnění uživatele pro vykonání určité akce, může při používání bota na serveru nastávat běžně. Proto není součástí logování a má svou připravenou odpověď. Tuto výjimku vyvolává dekorátor přidaný knihovnou, který kontroluje, zdali je uživatel administrátor. Vyvolání stejné výjimky bylo implementováno i do vlastní funkce pro kontrolu, která bere v potaz roli moderátora a nastavení oprávnění na daném serveru.
	
	U ostatních výjimek je do příslušného textového kanálu odeslán polední řádek jejich výpisu. Tento přístup není vždy žádoucí, protože může případným útočníkům pomoci lépe pochopit vnitřní implementaci programu. Zdrojové kódy tohoto bota jsou ale dohledatelné, jelikož je tvořen s možností provozu vlastní instance a případného rozšiřování jeho obsahu. Díky výpisu chyb do chatu mohou uživatelé tyto chyby snadněji nahlašovat.
	
	%Pro zdůraznění má text výpisu chyb červenou barvu. Barevný text na Discordu je ale značně omezen. Využívá možnosti odesílat zdrojové kódy se zvýrazněním syntaxe.
	
	\subsection{Implementace výkladu teorie}

	Před implementací logiky výkladu teorie byly vytvořeny samotné Markdown soubory. Ty ve formě převážně odrážkových výpisků pokrývají určitá témata z lineární algebry. Souborů je celkem 13 a zaměřují se především na vektorové prostory a lineární zobrazení mezi nimi.

	Pro výběr teoretického tématu se využívá výběrový seznam. Názvy jednotlivých položek v seznamu odpovídají názvům Markdown souborů, ze kterých se čerpají výpisky pro výklad teorie. Podobně jako u tlačítka lze u výběrového seznamu využít metody \textit{callback}, která se volá po zvolení některé z položek. Název zvolené položky je uložen do atributu, který je již předán do view obstarávajícího zobrazení výpisků.% (\textit{TheoryThemeView}).
	
	Po výběru určitého tématu se tedy odešle zpráva obsahující view pro teorii, které si z Markdown souboru načte výpisky ke zvolenému tématu do interní proměnné. Z toho důvodu se změna obsahu v souborech s výpisky projeví až při dalším použití příkazu \verb|/explain|. Text výpisků je podle nadpisů druhé úrovně rozdělen na jednotlivá podtémata, jejichž seznam je jediným obsahem úvodní zprávy. Tlačítka \textit{Další}, \textit{Předchozí} a nový výběrový seznam využívají metody ve view pro přepínání právě zobrazeného podtématu.
	
	Metoda pro změnu podtémat nejprve zpracuje text patřící k aktuálně vybranému podtématu a rozdělí ho na jednotlivé zprávy, které jsou následně odeslány do textového kanálu. Na odeslané zprávy si view drží referenci. Jakmile je podtéma opět změněno a odešlou se zprávy nové, ty staré se smažou a reference nyní ukazuje na ty nové. Před smazáním starých zpráv se jako nová rodičovská zpráva daného view nastaví ta poslední odeslaná. Díky tomu zůstanou ovládací prvky vždy dole.
	
	Odesílání a mazání více zpráv není okamžité. Discord API obsahuje endpoint pro instantní smazání většího množství zpráv, který je implementován v knihovně discord.py. Tato funkce ale během testování nefungovala spolehlivě a vybrané zprávy nebyly ve zdánlivě náhodných případech smazány. Zprávy navíc nebylo možné po použití této funkce smazat běžným způsobem jednu po druhé. Ekvivalentní endpoint pro odeslání více zpráv neexistuje, proto jsou zprávy odesílány i mazány po jednom. Pokud je zpráv více jak pět, byla mezi jednotlivé akce přidána krátká prodleva, aby se předešlo omezením proti spamu ze strany Discordu (\textit{rate limiting}).
		
	% - fwd to dms
	
	\subsection{Zpracování Markdown souborů}
	
	Při tvorbě materiálů pro výuku matematiky je často potřeba použít určitý matematický symbol nebo výraz jako součást věty. Discord ale neumožňuje horizontálně vkládat obrázky mezi text, a proto je jedinou možností použít znaky Unicode. Pro usnadnění je možné v Markdown souborech využít HTML značek \verb|sup| a \verb|sub| pro psaní horních a dolních indexů. Protože Discord tyto značky nepodporuje, je jejich obsah převeden na Unicode znaky při rozdělování textu do jednotlivých podtémat.
	
	Pro převod se používá Python balík \textit{UnicodeIt}. Vytvořené zápisky pro lineární algebru často používají dolní indexy. Počet znaků, které existují v Unicode ve variantě dolního indexu, je ale omezený. Pokud kvůli neexistujícímu znaku nedokáže UnicodeIt obsah značky \verb|sub| převést, je místo toho daný text vložen mezi zpětné uvozovky. Discord pak tuto část textu reprezentující dolní index zformátuje jako jednořádkový zdrojový kód: Písmo je neproporcionální, má menší velikost a tmavší pozadí. Text se díky tomu více odlišuje od zbytku a tváří se jako pomocný symbol.
	
	Pro nahrazení textu umístěného mezi dvoudolary za obrázek s vykresleným matematickým výrazem je nejprve celý text podle dvoudolarů rozdělen na části. Aby nebylo nutné detekovat, které části jsou určené pro vykreslení a které jsou obyčejný text, bylo přidáno pravidlo, že zprávy pro vykreslení musí začínat řetězcem \verb|$render|. V takovém případě je řetězec \verb|$render| zahozen a zbytek textu je vstupem vykreslovací funkce. Pravidla pro zápis jsou tedy stejná jako u příkazu \verb|/render|.
	
	Discord sice umožňuje, aby jediná zpráva najednou obsahovala text i obrázky, problémem ale je, že jsou všechny obrázky umístěny na konci zprávy pod veškerým textem. Proto je rozdělování na více zpráv jedinou možností, jak zajistit přesné umístění obrázků v odeslaném textu. Pokud zpráva obsahuje internetový odkaz, který míří na určitý obrázek, pak ho Discord automaticky zobrazí. Vepsáním takového odkazu mezi dvoudolary se opět zajistí správné umístění tohoto obrázku z internetu.
	
	Bot automaticky rozděluje zprávy, které jsou delší než 2000 znaků, kvůli omezením ze strany Discordu. Využívá se Python modulu \textit{textwrap}, díky kterému se rozdělení zprávy může nacházet pouze na místě mezery nebo nového řádku. Pokud by automatické rozdělení nebylo vhodně zvoleno, je možné opět použít dvoudolar, který značí, kde bude zpráva rozdělena.
	
	\subsection{Implementace generace příkladů}
	
	Podobně jako u výkladu teorie, implementace uživatelského rozhraní generátoru příkladů využívá komplexnějšího view. Logika odesílání zpráv s návodem po stisknutí tlačítka \textit{Jak počítat?} používá stejné funkce jako výklad teorie. Logika zobrazování příkladů a jejich výsledků se už liší.
	
	Dokud se nevyužije možnosti zobrazení návodu, který může být tvořen více odeslanými zprávami, tak je rodičovská zpráva daného view stále stejná a její obsah je modifikován na základě stisknutých tlačítek. Tato zpráva obsahuje text a maximálně jeden obrázek. View má v sobě uložený řetězec se zadáním a řešením aktuálního příkladu. Po generaci nového příkladu je obsahem zprávy text zadání a po kliknutí na \textit{Zobrazit výsledek} je obsah změněn na text řešení.
	
	Obrázek obsažený v rodičovské zprávě je vykreslením matematického výrazu, jehož předpis je součástí řetězců se zadáním a řešením. Řetězec obsahuje nejprve textovou část zprávy a pokud jsou následně zapsány tři znaky dolaru, vše za nimi je považováno jako předpis výrazu pro vykreslení. Styl zápisu byl oproti \mbox{Markdown} souborům takto zjednodušen, protože zde není potřeba obsah rozdělovat do více zpráv a vykreslovat více obrázků.
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=\textwidth]{img/ProblemsDiagram}
		\caption{Diagram tříd generátoru příkladů}
		\label{_tag_img_problemuml}
	\end{figure}
	
	Pro snadné implementování nových kategorií příkladů byla navržena struktura tříd, kterou popisuje obrázek \ref{_tag_img_problemuml}. Abstraktní třída \textit{GeneralProblem} obsahuje řetězce pro zadání a řešení příkladu. Pro jejich nastavení slouží metoda, která je definována v potomcích této třídy. Každý potomek reprezentuje jednu kategorii příkladů a nachází se ve vlastním souboru. Soubory jsou součástí balíku \textit{problems} kvůli snadnějšímu importování. O poskytnutí řetězců k vybrané kategorii se stará \mbox{\textit{ProblemManager}}, který obsahuje všechny potomky \textit{GeneralProblem}. Tato vrchní trojice bloků je nezávislá na platformě Discord a společně s logikou pro vykreslování matematických výrazů by mohla být použita v jakékoliv Python aplikaci.
	
	Spodní část diagramu je závislá na knihovně discord.py. Cog po zadání příkazu odešle zprávu s view, které obsahuje instanci \textit{ProblemManager}. Z ní si view získá seznam dostupných kategorií pro naplnění výběrového seznamu a řetězce se zadáním a řešením, pokud je stisknuto příslušné tlačítko. View se také stará o načtení Markdown souboru s návodem pro výpočet, pokud nějaký existuje.
	
	Do bota byly přidány generátory příkladů pro výpočet násobení matic, soustav rovnic, inverzních matic, vlastních vektorů a determinantu. Příklady pro výpočet soustavy rovnic obsahují tři neznámé a vedou na Gaussovu–Jordanovu eliminační metodu. Příklad tedy začíná maticí s rozměrem 3$\times$3, která musí být převedena na jednotkovou, a tříprvkovým vektorem s výsledky. Pokud by byla počáteční matice vygenerována úplně náhodně, výsledek by pak pravděpodobně obsahoval desetinná čísla, což není pro výukové materiály vhodné. Proto je nejdříve vytvořena jednotková matice, na které je provedeno několik náhodných gaussovských operací, které nemění její lineární obal. Pro snazší kontrolu obsahuje řetězec s řešením kromě výsledku i mezikrok výpočtu, ve kterém je matice v horním stupňovitém tvaru. Pro tento účel je použita metoda LU rozkladu bez zlomků z balíku SymPy. Po použití této metody je ještě každý řádek matice vydělen jeho největším společným dělitelem. Tato podoba matice se totiž nejvíce podobá té, ke které se uživatel dopracuje při ručním výpočtu Gaussovy eliminační metody.
	
	Další kategorií příkladů, kde není vhodné generovat zadání úplně náhodně, je výpočet inverzní matice. V tomto případě je potřeba vygenerovat celočíselnou matici, jejíž inverze je také tvořena celými čísly. Tento požadavek splňují matice, které mají determinant roven $\pm1$. Determinant matice v horním (nebo dolním) stupňovitém tvaru je roven součinu jejích diagonálních prvků a determinant součinu dvou čtvercových matic stejné velikosti je roven součinu determinantů těchto dvou matic \cite{lit_lingebra}. Náhodnou matici, která má determinant roven jedné, tedy lze vytvořit součinem dvou matic, kde jedna je v horním a druhá v dolním stupňovitém tvaru. Obě matice mají na diagonále samé jedničky, aby byl jejich determinant roven jedné, a zbylé prvky jsou zvoleny náhodně.
	
	% eigenvalues/eigenvectors
	
	\subsection{Databáze}
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=\textwidth]{img/Database}
		\caption{Databáze}
		\label{_tag_img_db}
	\end{figure}
	
	Požadavky bota na databázi nejsou vysoké. Je potřeba ukládat nastavení barevného schématu pro vykreslování matematických výrazů, pokud jej uživatel nebo administrátor změní. Dále je pro každý server, na kterém se bot nachází, ukládán identifikátor moderátorské role LingeMod. Pokud by bot detekoval roli pomocí jejího názvu a role by byla přejmenována, přestala by pak moderace fungovat. Poslední tabulka uchovává nastavení oprávnění pro jednotlivé servery.
	
	Pro takovýto účel byla zvolena databáze SQLite. Mnoho neoficiálních tutoriálů pro tvorbu Discord botů používá jako databázi přímý zápis a čtení ze souborů JSON. Tento způsob je nevhodný, protože není zaručena žádná bezpečnost transakcí a veškerá režie je zanechána na programátorovi. Pokus o implementaci vlastní režie by vedl k naprogramování vlastního databázového systému, proto je vhodnější obrátit se na již hotová a ověřená řešení. SQLite je embedded databáze, která je pro potřeby tohoto bota dostačující a kterou jazyk Python nativně podporuje.
	
	Identifikátory serverů, rolí a uživatelů jsou spravovány na straně Discordu. Každá funkce v knihovně discord.py, která reaguje na událost jako zadání příkazu uživatelem, má jako první vstupní parametr objekt typu interakce (\textit{discord.Interaction}), ze kterého lze zjistit ID daného uživatele a serveru, kde byl příkaz zadán. 
	
	Pokud např. uživatel zadá příkaz pro změnu barevného schématu, tak je ID daného serveru získáno z objektu interakce a v tabulce je k němu přiřazen název zvoleného schématu. Pokud je příkaz zadán v přímých zprávách, pak je místo ID serveru, které v tomto kontextu neexistuje, použito ID uživatele. Všechny Discord identifikátory by měly být unikátní, a proto nejsou potřeba dvě tabulky pro schémata serveru a schémata uživatelů. Při použití příkazu \verb|/render| je pak z interakce opět zjištěno ID, pomocí něhož se v databázi dohledá nastavené barevné schéma, které se použije pro vykreslení.
	
	Identifikátory jsou tedy podle potřeby získávány z Discord API. V případě tohoto bota proto může být databáze jednoduchá a tabulky mezi sebou nemusí mít žádné vazby. Definice databáze ze strany SQL obsahuje pouze názvy tabulek a jejich sloupců. Ostatní logika se odehrává na straně programu v jazyce Python.
	
	Pro reprezentaci hodnot uchovávajících barevné schéma a oprávnění se používá typ \textit{Literal} z modulu \textit{typing}, který může nabývat jen předem definovaných hodnot. Literal je podporován knihovnou discord.py a pokud je nastaven jako datový typ argumentu příkazu, pak Discord uživateli povolí příkaz odeslat jen tehdy, když je zadaný argument roven některé z předem definovaných hodnot. K hodnotám je navíc dostupné našeptávání.
	
	Typ \textit{ThemeLiteral} může nabývat čtyř různých řetězců, které reprezentují jednotlivá barevná schémata. Tyto řetězce jsou přímo ukládány do databáze k příslušnému ID. U nastavení oprávnění existují dva typy: jeden pro zadání příkazu a druhý pro interakci s tlačítky a výběrovými seznamy. Tyto typy jsou před uložením do databáze převedeny na čísla 0, 1, nebo 2 (viz obrázek \ref{_tag_img_db}). SQLite nepodporuje výčtové typy, a proto se tato konverze opět odehrává na straně hlavního programu.
	
	\subsection{Implementace moderace}
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=\textwidth]{img/SetupCommands}
		\caption{Seznam příkazů pro nastavení}
	\end{figure}
	
	Příkazy \verb|/setup| jsou součástí tzv. skupiny podpůrných příkazů. Běžný příkaz je zapsán pomocí lomítka, po němž následuje název příkazu, který musí být jednoslovný. Příkazy ze skupiny se zadávají ve tvaru \verb|/<název_skupiny> <název_příkazu>|. Díky tomu mohou mít podobné příkazy stejný začátek a seznam příkazů je tak přehlednější. Skupiny příkazů je možné vnořovat, toho využívají příkazy \verb|/setup permissions|.
	
	Spuštění jednoho z příkazů nastavujících oprávnění změní v tabulce \textit{permissions} na řádku daného serveru příslušný atribut. Záznam v tabulce není přidán hned po připojení bota na server, ale až po prvním spuštění nastavujícího příkazu. Dokud záznam neexistuje, využívá se výchozích hodnot definovaných ve zdrojovém kódu. První volání příkazu nejprve přidá řádek s těmito výchozími hodnotami do tabulky a pak změní vybraný atribut.
	
	Při každém pokusu o spuštění příkazu nebo interakci s view jako první proběhne kontrola oprávnění. Funkce obstarávající tuto kontrolu přistupuje do databáze a má k dispozici objekt interakce, ze kterého lze zjistit údaje o daném uživateli. Pokud má uživatel dostatečná oprávnění, funkce proběhne bez efektu a obsluha jeho interakce může pokračovat. Při nedostatečných právech je vyhozena výjimka, na kterou reaguje cog \textit{on\_error}. V tomto případě je do chatu odeslána zpráva informující o nedostatečných právech.
	
	Implementace funkce kontroly minimalizuje počet přístupů do databáze. Administrátorům je např. vždy povoleno použít jakýkoliv příkaz nehledě na nastavení oprávnění daného serveru. Nastavení je z databáze získáno až poté, co je z objektu interakce zjištěno, že uživatel administrátorem není. Identifikátor role LingeMod je z databáze získán až v posledním případě, kdy je zjištěno, že příkaz není dostupný všem.
	
	% /setup @app_commands.guild_only : Due to a Discord limitation, this decorator does nothing in subcommands and is ignored.
	% $> lingemod_reset
	% --------------------------------------------------------------------------------------------------------------------------
	% Příkaz /dm
	% $> slash_sync
	% - Problém testování nových funkcí u již nasazeného bota, udělat druhého ? (pak je problém slash commands sync (to by mohly řešit hybridní příkazy (u nich je ale problém ctx vs itx ?)))
		
	\section{Nasazení a zpětná vazba}
	
	Po implementaci všech navrhovaných funkcí byl bot nasazen do testovacího provozu a zpřístupněn skupině uživatelů na otestování. Součástí bylo také dotazníkové šetření, kterého se zúčastnilo celkem devět respondentů.
	
	$ $% Kdo jsou respondenti ?
	
	<< GRAFY DO PŘÍLOHY, ZDE SE K NIM VYJÁDŘIT ? >>
	
	\subsection{Návrhy na vylepšení}
	
	Pro efektivnější procházení teoretických výpisků u příkazu \verb|/explain| by bylo vhodné přidat funkci vyhledávání. Výběrový seznam teoretických témat obsahuje pouze jejich názvy a nemusí být jasné, co vše je v nich obsaženo. Vyhledávání by šlo implementovat buď pomocí textového pole, nebo nového příkazu, kde by jediným argumentem byl řetězec pro vyhledání. Interaktivní prvek textového pole nemůže být součástí běžného view a lze použít pouze ve vyskakovacím okně. To by se vyvolalo buď příkazem, nebo reakcí na stisk tlačítka. Po zadání hledaného výrazu by byla uživateli vypsána všechna (pod)témata, kde se daný výraz nachází. Zobrazení výňatků z výpisků se zvýrazněním hledaných slov by už bylo složitější, protože podpora barevného písma na Discordu je velmi omezená a formátování např. na tučné písmo by mohlo rozbít již přítomný Markdown zápis. Také by bylo vhodné přidat intuitivní způsob, kterým by si uživatel mohl rychle zobrazit vybrané podtéma ze seznamu výsledků vyhledávání. Výběrový seznam se jeví jako nejvhodnější, protože může mít proměnný počet položek.
	
	U příkazu \verb|/generate| lze vždy generovat příklady pouze z jedné kategorie. Pro změnu je potřeba stisknout příslušné tlačítko a následně vybrat jinou kategorii z výběrového seznamu. Pro vylepšení by šla přidat funkce, která by vygenerovala sadu příkladů napříč více kategoriemi. Příklady by se buď postupně, nebo najednou ukázaly uživateli. Případně by mohl být přidán časový limit, během kterého by se uživatel musel pokusit stihnout všechny příklady vypočítat.
	
	Při tvorbě teoretických výpisků a návodů pro počítání příkladů je možné \mbox{používat} pouze obrázky z internetu. Pro flexibilnější tvorbu by bylo vhodné přidat podporu vkládání obrázků z disku. Pravidla pro zápis vložení obrázku by ideálně měla dodržovat syntaxe jazyka Markdown, aby při tvorbě zápisků v libovolném editoru fungoval náhled i s obrázky. Cesty k souborům s těmito obrázky, které se uvádějí v Markdown souborech a jsou k nim relativní, by případně musely být převedeny na cesty relativní ke kořenu projektu, aby mohly být dosazeny do příslušného parametru v discord.py.
	
	Z pohledu zdrojového kódu je nedostatkem způsob práce s databází. Potřeby bota pro databázi jsou minimální a z důvodu záměru zachování této jednoduchosti nebylo žádoucí, aby kvůli ní musela běžet další aplikace. Vzhledem ke struktuře ukládaných dat by se k tomuto projektu více hodila dokumentová NoSQL databáze. Žádné zavedené embedded NoSQL řešení ale nebylo nalezeno, a proto byla zvolena databáze SQLite. S tou se pracuje přímo pomocí Python modulu \textit{sqlite3} a její schéma je tvořeno ,,ručně`` příkazy typu \verb|CREATE TABLE|. Vhodnější by bylo použít balík \textit{SQLAlchemy}, který by usnadnil modifikaci stávajícího schématu a případný přechod na alternativní databázový systém.
	
	Jak je zmíněno v \ref{_tag_section_approxtexlen}, funkce pro aproximaci délky vykreslených matematických výrazů podporuje pouze podmnožinu všech možných vstupů. Pro její vylepšení by se musel druhý krok rozšířit o rozvětvení, které by explicitně reagovalo na určité TeX příkazy. Např. \verb|\sin| by nahradil řetězcem o délce tří a \verb|\sinh| o délce čtyř znaků. 
	
	%Pro demonstraci specifických funkcí Discordu byla přidána moderace, která využívá systém serverových rolí. Roli LingeMod lze uživatelům přidělit přes uživatelské rozhraní Discordu nebo jedním z příkazů \verb|/setup|. Dalším možným způsobem...	
	% /explain - Zápisky: příklady/souvislosti, vizualizace)
	% Z pohledu Discord fcí (Multilang commands (i témata)), (threads)
		
	\subsection{Vhodnost platformy Discord}
	
	Discord je platforma s početnou komunitou uživatelů, která disponuje komplexním API pro tvorbu botů. Většina populárních botů se zaměřuje na servery s velkým počtem členů a nabízí usnadnění moderace, nebo přidává nové sociální funkce. Díky možnosti vytvoření soukromých serverů a komunikace s botem v přímých zprávách lze ale na platformě Discord nasadit řešení pro jakoukoliv cílovou skupinu.
	
	Vzdělávání i matematika mají na Discordu své místo, botů zaměřených na výuku je ale málo. Jedním z důvodů jsou pravděpodobně přirozená omezení vycházející z prostředí textového chatu. Kromě hlasového hovoru je odeslaná zpráva jediný způsob, jakým může bot uživateli předat určitou informaci. K dispozici jsou sice interaktivní prvky jako tlačítka, která lze ke zprávě přidat, oproti webovým a desktopovým aplikacím jsou ale možnosti pro tvorbu rozhraní značně omezené. Jednou z výzev při tvorbě bota v této práci tedy bylo vymyšlení co nejpřirozenějšího rozhraní, které za pomoci převážně odesílání, upravování a mazání zpráv dokáže uživateli zprostředkovat dané matematické materiály.
	
	V tomto ohledu není Discord nejvhodnějším prostředím pro nasazení takovéto aplikace. Na druhou stranu se jedná o platformu populární mezi studenty a i všichni oslovení testeři zde již měli založený účet. Díky systému podpůrných příkazů a prostředkům pro tvorbu rozhraní, které jsou sice omezené, ale jednotné, by pro uživatele mělo být snazší pochopit ovládání libovolného bota.
	
	Discord může sloužit i jako platforma pro online výuku ve školách. Vyučující by v tomto případě do bota vložil své teoretické materiály, ze kterých by pak studenti mohli čerpat a při neporozumění určitému tématu začít diskuzi v textovém kanálu. K lepšímu vyjádření pak slouží příkaz \verb|/render|, díky kterému není nutné pro potřebu odeslání matematického výrazu opustit okno chatu a použít externí aplikaci. Vyučující by také mohl chtít bota použít jako doprovod ke svému výkladu v hlasovém hovoru, pak by se např. nastavilo oprávnění, že příkaz \verb|/explain| mohou používat pouze administrátoři.
	
	Výhodou Discordu je jeho dostupnost na všech hlavních desktopových i mobilních operačních systémech a také ve webové aplikaci. Uživatelovi konverzace jsou okamžitě synchronizovány na všech jeho zařízeních. Pro uživatele, kteří Discord nepoužívají, může být odrazující nutnost zakládat si kvůli použití bota účet.
	
	Nevýhodou Discord botů je jejich závislost na této platformě. Bot, který využívá specifických funkcí Discordu, nepůjde snadno přesunout na jinou platformu. Discord je proprietární a nelze provozovat jeho vlastní instanci. Pokud je platforma z důvodu výpadku nedostupná, pak je bot také nedostupný.
	
	Dva měsíce po nasazení bota přestal Discord interpretovat text ohraničený podtržítky jako kurzívu, pokud se přímo za ním nacházela otevírající závorka. Zpráva napsaná jako \verb|_f_(_x_)| se tedy místo ,,$f(x)$`` nyní zobrazuje jako ,,$\_\mathrm{f}\_(x)$``. Kvůli tomu musela být všechna podtržítka v teoretických materiálech u těchto případů nahrazena hvězdičkami. Pro Discord vychází aktualizace minimálně jednou za měsíc a instalují se automaticky. Takovéto změny mohou nečekaně změnit chování bota.

	% * Rozdíly mezi PC/web/phone/...
	
	\chapter{Závěr}
	
	% Stručné shrnutí celé práce
	% – Shrnutí nejdůležitějších bodů ze všech kapitol do krátkého závěrečného textu, včetně zhodnocení výsledků a přínosu práce a návrhu možného budoucího pokračování
	
	% V této kapitole by mělo být umístěno zhodnocení celé zprávy, posouzení kvality výsledků, srovnání s jinými metodami, porovnání s cíli práce a posouzení jejich splnění. Text by neměl zacházet do přílišných podrobností	a neměly by se zde opakovat pasáže z hlavního textu. Je zde možné uvést i případná	návazná témata, či možnosti pokračování.
	
	%(a) Diskutuji v závěru shodu mezi zadánı́m a dosaženými výsledky?
	
	%\section{Výsledek práce}
	
	%V rámci této bakalářské práce byla nejprve v kapitole \ref{Chapter2} provedena rešerše sociálních platforem, které oficiálně podporují integraci botů.
	
	V rámci této bakalářské práce byl vytvořen matematický bot pro sociální platformu Discord zvaný LingeBot. Ten byl implementován v jazyce Python za pomoci knihovny discord.py. Jeho třemi hlavními prvky jsou vykreslování matematických výrazů, výklad teorie a generování příkladů z lineární algebry. Veškeré funkce bota probíhají v prostředí textového chatu a lze je spouštět pomocí tzv. podpůrných příkazů, které začínají lomítkem.
	
	Příkaz \verb|/render| vloží do textového kanálu obrázek s vykresleným matematickým výrazem, který odpovídá uživatelskému vstupu. Formát vstupního řetězce je podobný jazyku TeX a pro vykreslení se využívá balík Matplotlib, jehož funkce jsou ale v tomto ohledu omezené. Bot byl proto rozšířen o vlastní funkce pro vykreslování matic libovolných rozměrů. Matice mohou být součástí delších rovnic a rovnice lze rozdělit na více řádků s případným nastavení zarovnání.
	
	Příkaz \verb|/explain| poskytuje rozhraní výkladu teorie. Pro účely bota byly vytvořeny materiály z lineární algebry pokrývající především témata vektorových prostorů a zobrazení mezi nimi, obecně je ale podporován jakýkoliv typ matematických materiálů. Jednotlivá teoretická témata jsou psána v jazyce Markdown a uložena v samostatných souborech. Bot pak formátovaný text z těchto souborů odesílá do textového kanálu. Soubory lze upravovat bez nutnosti restartování bota. %podporuje jakýkoliv typ matematických materiálů
	
	Příkaz \verb|/generate| poskytuje rozhraní pro generaci příkladů. Uživatel si může nechat vygenerovat příklad z vybrané kategorie a následně si zobrazit výsledek s případným postupem řešení. Při implementaci byl kladen důraz na snadnou rozšiřitelnost mechanismu o nové kategorie příkladů.
	
	Pro demonstraci specifických funkcí platformy Discord byly přidány možnosti moderace. Bot po připojení na server vytvoří moderátorskou roli zvanou LingeMod, díky které může administrátor rozdělit členy serveru na dvě skupiny. Pro jednotlivé příkazy pak lze nastavit, jaká oprávnění uživatel musí mít, aby je mohl na daném serveru použít. Rozhraní výkladu teorie a generátoru příkladů pak pro své ovládání využívá interaktivních prvků jako tlačítek a výběrových seznamů.
	
	% LZE PROVOZOVAT VLASTNí INSTANCI
	% VHODNOST PLATFORMY DISCORD
	
	Nasazení a dotazník \dots % + finální zhodnocení (jak zlepšit); přínos a budoucnost?

	\iffalse
	\section{Shrnutí obsahu}
	
	Kapitola \ref{Chapter2} popisuje, jak jsou v kontextu této práce myšleny výrazy \textit{sociální platforma} a \textit{bot}. Následně je provedena rešerše sociálních platforem, které integraci botů oficiálně podporují. Nejvíce pozornosti je věnováno platformě Discord, která je následně vybrána pro implementaci bota. Důvodem výběru je dobře zdokumentovaný ekosystém botů, kolem kterého vznikla početná komunita.
	
	Kapitola \ref{Chapter3} krátce popisuje, jaké postavení má téma matematiky na platformě Discord. Následně jsou shrnuty dva základní typy matematických botů, které se na této platformě vyskytují.
	
	Kapitola \ref{Chapter4} \dots
	\fi

	% Zdroje
	\chapter*{Seznam použité literatury}
	\addcontentsline{toc}{chapter}{Seznam použité literatury}
	\printbibliography[heading=none]
	
	% Přílohy
	\appendix
	\chapter{Přílohy}
	
	\section{Odkazy zdrojové kódy a manuál}
	
	\begin{itemize}
		\item Zdrojové kódy bota a této zprávy jsou dostupné na: \\\url{https://github.com/RadekMocek/BP}%.
		\item Manuál pro použití bota je dostupný na: \\\url{https://radekmocek.github.io/PDO}%.
		\item Hlavní instanci bota lze pozvat na server pomocí odkazu: \\ \href{https://discord.com/oauth2/authorize?client_id=1160906076179415070&permissions=2416045056&scope=bot+applications.commands}{\texttt{https://discord.com/oauth2/authorize\\?client\_id=1160906076179415070\\\&permissions=2416045056\\\&scope=bot+applications.commands}}%.
	\end{itemize}
	
	\section{Výsledky dotazníkového šetření}
	
	\section{Zdrojové kódy implementace ukázkového příkazu}\label{Appendix3}
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=\textwidth]{img/ExampleCommand}
		\caption{Ukázkový příkaz: Vstup a výstup}
	\end{figure}
	
	\begin{figure}[ht]
		\lstinputlisting[language=Python3]{code/discord.py}
		\caption{Ukázkový příkaz: Implementace v discord.py}
	\end{figure}
	
	\begin{figure}[ht]
		\lstinputlisting[language=JavaScript]{code/discord.js}
		\caption{Ukázkový příkaz: Implementace v discord.js}
	\end{figure}
	
	\begin{figure}[ht]
		\lstinputlisting[language={CSharp}]{code/discord.cs}
		\caption{Ukázkový příkaz: Implementace v Discord.Net}
	\end{figure}
	
	\begin{figure}[ht]
		\lstinputlisting[language={Java18}]{code/discord.java}
		\caption{Ukázkový příkaz: Implementace v JDA}
	\end{figure}
	
\end{document}